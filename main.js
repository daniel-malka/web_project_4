!function(){"use strict";class t{constructor(t,e,s,r,n,i){var o,a;a=()=>{this._cardElement.remove(),this._cardElement=null},(o="removeCard")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._name=t.name,this._userId=e,this._link=t.link,this._likes=t.likes,this._owner=t.owner._id,this._id=t._id,this._handleCardClick=r,this._handleLikeButton=n,this._handleDelete=i,this._alt="Photo of ".concat(t.name),this._templateElement=s}isLiked(){return this._likes.some((t=>t._id==this._userId))}getId(){return this._id}_setEventListeners(){this._deleteCard.addEventListener("click",(()=>this._handleDelete(this._id))),this._likeCard.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._galleryImg.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}_addLike(){this._likeCard.classList.add("button_liked")}_removeLike(){this._likeCard.classList.remove("button_liked")}setLikes(t){this._likes=t,console.log(this._owner,"owner",this._userId,"userId"),this._renderLikes()}_hideDeleteButton(){this._owner!==this._userId&&(this._deleteCard.style.display="none")}_renderLikes(){this.isLiked()?this._addLike():this._removeLike();const t=this._likes.length;this._counterLikes.textContent=t}_generateCard(){return this._cardElement=document.querySelector(this._templateElement).content.querySelector(".gallery__item").cloneNode(!0)}createCard(){return this._cardElement=this._generateCard(),this._galleryImg=this._cardElement.querySelector(".gallery__img"),this._galleryText=this._cardElement.querySelector(".desc__text"),this._deleteCard=this._cardElement.querySelector(".gallery__bin"),this._likeCard=this._cardElement.querySelector(".like__button"),this._counterLikes=this._cardElement.querySelector(".like__counter"),this._galleryText.textContent=this._name,this._galleryImg.src=this._link,this._galleryImg.alt=this._alt,this._renderLikes(),this._hideDeleteButton(),this._setEventListeners(),this._cardElement}}function e(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class s{constructor(t,s){e(this,"resetValidation",(()=>{this._hideAllErrors(),this._disableButton()})),e(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(t=>t.preventDefault())),this._setEventListeners()})),e(this,"_setEventListeners",(()=>{this._allInputs.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButton()}))}))})),e(this,"_hideAllErrors",(()=>{this._allInputs.forEach((t=>{this._hideInputError(t)}))})),e(this,"_disableButton",(()=>{const{buttonDisable:t}=this._settings;this._buttonEl.classList.add(t),this._buttonEl.disabled=!0})),e(this,"_showInputError",((t,e)=>{const{inputErrorClass:s,spanErrorClass:r}=this._settings;this._errorElement=this._formElement.querySelector(".fieldset__error-type-".concat(t.id)),t.classList.add(s),this._errorElement.textContent=e,this._errorElement.classList.add(r)})),e(this,"_hideInputError",(t=>{const{inputErrorClass:e,spanErrorClass:s}=this._settings;this._errorElement=this._formElement.querySelector(".fieldset__error-type-".concat(t.id)),t.classList.remove(e),this._errorElement.classList.remove(s),this._errorElement.textContent=""})),e(this,"_checkFormValidity",(()=>this._allInputs.every((t=>t.validity.valid)))),e(this,"_toggleButton",(()=>{const{buttonDisable:t}=this._settings;this._checkFormValidity()?this._enableButton():this._disableButton()})),e(this,"_checkInputValidity",(t=>{t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)})),this._settings=t,this._formElement=s,this._allInputs=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonEl=this._formElement.querySelector(this._settings.buttonSelector)}_enableButton(){const{buttonDisable:t}=this._settings;this._buttonEl.classList.remove(t),this._buttonEl.disabled=!1}}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class n{constructor(t){r(this,"_handleOverlay",(t=>{t.target.classList.contains("popup")&&this.close()})),r(this,"_handleEscClose",(t=>{"Escape"===t.key&&this.close()})),this._popup=document.querySelector(t)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",this._handleOverlay),this._popup.querySelector(".popup__close").addEventListener("mousedown",(()=>this.close()))}}class i extends n{constructor(t,e){super(t),this._handleForm=e,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button"),this._submitButtonText=this._submitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".fieldset__input"))}_getInputValues(){const t={};return this._inputs.forEach((e=>{const s=e.name,r=e.value;t[s]=r})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._handleForm(e)}))}renderLoading(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=t?e:this._submitButtonText}close(){super.close(),this._form.reset()}}const o=".gallery",a=document.forms.formProfile.elements.name,l=document.forms.formProfile.elements.about,h=(document.forms.formAvatar.elements.link,document.querySelector(".text__edit")),c=document.querySelector(".top__plus-box"),_=document.querySelector(".top__container-image"),d={inputSelector:".fieldset__input",buttonSelector:".fieldset__button",buttonDisable:"fieldset__button_disabled",inputErrorClass:"fieldset__input_error",spanErrorClass:"fieldset__error-message-active"},u=new class{constructor(t){this._baseUrl=t.baseUrl}_headers(){return{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}}_customFetch(t,e){return fetch(t,e).then((t=>t.ok?t.json():Promise.reject(t.statusText)))}getCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers()})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers()})}setUserInfo(t){let{name:e,about:s}=t;return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers(),method:"PATCH",body:JSON.stringify({name:e,about:s})})}addCard(t){let{name:e,link:s}=t;return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers(),method:"POST",body:JSON.stringify({name:e,link:s})})}editAvatar(t){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers(),method:"PATCH",body:JSON.stringify({avatar:t})})}deleteCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(t),{headers:this._headers(),method:"DELETE"})}dislikeCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{headers:this._headers(),method:"DELETE"})}likeCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{headers:this._headers(),method:"PUT"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}}),m=new class extends n{constructor(t){super(t),this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button-type-save"),this._submitButtonText=this._submitButton.textContent}setAction(t){this._submitHandler=t}setEventListeners(){this._popup.addEventListener("submit",(t=>{t.preventDefault(),this._submitHandler()})),super.setEventListeners()}renderLoading(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitButton.textContent=t?e:this._submitButtonText}}(".popup_type_delete");let p;m.setEventListeners();const b=new class{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderInitialItems(t){t.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}((t=>{g(t)}),o),g=t=>{b.addItem(v(t))},E=new class{constructor(t){this._userName=document.querySelector(t.name),this._userAbout=document.querySelector(t.about),this._userAvatar=document.querySelector(t.avatar)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent,avatar:this._userAvatar.src}}setUserInfo(t){let{nameInput:e,aboutInput:s}=t;this._userName.textContent=e,this._userAbout.textContent=s}setAvatar(t){this._userAvatar.src=t}}({name:".text__name",about:".text__about",avatar:".top__img"});Promise.all([u.getUserInfo(),u.getCards()]).then((t=>{let[e,s]=t;p=e._id,E.setUserInfo({nameInput:e.name,aboutInput:e.about}),E.setAvatar(e.avatar),b.renderInitialItems(s)})).catch((t=>console.log("Error somthing went wrong. ".concat(t))));const v=e=>{const s=new t(e,p,"#gallery__item",((t,e)=>{L.open(t,e)}),(t=>{s.isLiked()?u.dislikeCard(t).then((t=>{s.setLikes(t.likes)})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))):u.likeCard(t).then((t=>{s.setLikes(t.likes)})).catch((t=>console.log("Error somthing went wrong. ".concat(t))))}),(t=>{m.open(),m.setAction((()=>{m.renderLoading(!0,"Deleting..."),u.deleteCard(t).then((t=>{s.removeCard(),m.close()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{m.renderLoading(!1)}))}))}));return s.createCard()},f=new i(".popup_type_card",(t=>{f.renderLoading(!0,"Saving..."),u.addCard({name:t.title,link:t.link}).then((t=>{g(t,o),f.close()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{f.renderLoading(!1)}))})),y={};Array.from(document.querySelectorAll(".form")).forEach((t=>{const e=new s(d,t),r=t.getAttribute("name");y[r]=e,e.enableValidation()}));const L=new class extends n{constructor(t){super(t),this._popup=document.querySelector(t),this._caption=this._popup.querySelector(".popup__caption"),this._image=this._popup.querySelector(".popup__img")}open(t,e){this._caption.textContent=t,this._image.src=e,this._image.alt="Photo of ".concat(t),super.open()}}(".popup_type_zoom");L.setEventListeners();const k=new i(".popup_type_profile",(t=>{k.renderLoading(!0," Adding..."),u.setUserInfo({name:t.name,about:t.about,avatar:t.avatar}).then((t=>{E.setUserInfo({nameInput:t.name,aboutInput:t.about,avatarInput:t.avatar}),k.close(),E.setAvatarInfo(t.avatar)})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{k.renderLoading(!1)}))}));k.setEventListeners();const C=new i(".popup_type_avatar",(t=>{(t=>{C.renderLoading(!0,"Changing..."),u.editAvatar(t.url).then((t=>{E.setAvatar(t.avatar)})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{C.renderLoading(!1)}))})(t),C.close()}));c.addEventListener("click",(()=>{y[formImg.getAttribute("name")].resetValidation(),f.open()})),f.setEventListeners(),h.addEventListener("click",(()=>{y[formProfile.getAttribute("name")].resetValidation(),E.getUserInfo(),(()=>{const{name:t,about:e}=E.getUserInfo();a.value=t,l.value=e})(),k.open()})),C.setEventListeners(),_.addEventListener("click",(()=>{y[formAvatar.getAttribute("name")].resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LG9CQUVaLE1BQU11RyxFQUFnQixJQUFJckcsRUYzTE4sc0JFMkxrQ3hHLElBckMxQkEsS0FDMUI2TSxFQUFjdkYsZUFBYyxFQUFNLGVBQ2xDZSxFQUFBQSxXQUNjckksRUFBSzJJLEtBQ2hCRyxNQUFNQyxJQUNMbUMsRUFBU0ksVUFBVXZDLEVBQUllLE9BQXZCLElBRUQ2QixPQUFPQyxHQUFRckosUUFBUUMsSUFBUixxQ0FBMENvSixNQUN6REksU0FBUSxLQUNQYSxFQUFjdkYsZUFBYyxFQUE1QixHQVBKLEVBb0NBd0YsQ0FBbUI5TSxHQUNuQjZNLEVBQWM3RyxPQUFkLElBTUZtQyxFQUFnQnJHLGlCQUFpQixTQUFTLEtBL0N4Q3FLLEVBQWVZLFFBQVFSLGFBQWEsU0FBU1Msa0JBa0Q3Q2YsRUFBWTlGLE1BQVosSUFFRjhGLEVBQVkzRixvQkFFWjJCLEVBQWlCbkcsaUJBQWlCLFNBQVMsS0FoQ3pDcUssRUFBZXRFLFlBQVkwRSxhQUFhLFNBQVNTLGtCQUM3QjlCLEVBQVM1QixjQVJDLE1BQzlCLE1BQU0sS0FBRTVJLEVBQUYsTUFBUXNILEdBQVVrRCxFQUFTNUIsY0FDakMzQixFQUFVUCxNQUFRMUcsRUFDbEJxSCxFQUFXWCxNQUFRWSxDQUFuQixFQU1BaUYsR0FDQU4sRUFBWXhHLE1BOEJhLElBRzNCMEcsRUFBY3ZHLG9CQUVkOEIsRUFBZ0J0RyxpQkFBaUIsU0FBUyxLQS9EeENxSyxFQUFlakUsV0FBV3FFLGFBQWEsU0FBU1Msa0JBaUVoREgsRUFBYzFHLE1BQWQsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxpdGllcy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgc2VsZWN0b3IsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uLFxyXG4gICAgaGFuZGxlRGVsZXRlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XHJcbiAgICB0aGlzLl9hbHQgPSBgUGhvdG8gb2YgJHtkYXRhLm5hbWV9YDtcclxuICAgIHRoaXMuX3RlbXBsYXRlRWxlbWVudCA9IHNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9saWtlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZClcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2FkZExpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QuYWRkKFwiYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUxpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXMobmV3TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9vd25lciwgXCJvd25lclwiLCB0aGlzLl91c2VySWQsIFwidXNlcklkXCIpO1xyXG5cclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG4gIF9oaWRlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX293bmVyICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9hZGRMaWtlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9yZW1vdmVMaWtlKCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBsaWtlc0Ftb3VudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIHRoaXMuX2NvdW50ZXJMaWtlcy50ZXh0Q29udGVudCA9IGxpa2VzQW1vdW50O1xyXG4gIH1cclxuICBfZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlRWxlbWVudClcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2VuZXJhdGVDYXJkKCk7XHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pbWdcIik7XHJcbiAgICB0aGlzLl9nYWxsZXJ5VGV4dCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY19fdGV4dFwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUNhcmQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2JpblwiKTtcclxuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9jb3VudGVyTGlrZXMgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpa2VfX2NvdW50ZXJcIik7XHJcbiAgICB0aGlzLl9nYWxsZXJ5VGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nLmFsdCA9IHRoaXMuX2FsdDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgICB0aGlzLl9oaWRlRGVsZXRlQnV0dG9uKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9hbGxJbnB1dHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuX2J1dHRvbkVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc2V0dGluZ3MuYnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9oaWRlQWxsRXJyb3JzKCk7XHJcbiAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4gZXZ0LnByZXZlbnREZWZhdWx0KCkpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9hbGxJbnB1dHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlQWxsRXJyb3JzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fYWxsSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0pO1xyXG4gIH07XHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIGNvbnN0IHsgYnV0dG9uRGlzYWJsZSB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9idXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGJ1dHRvbkRpc2FibGUpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbiAgX2Rpc2FibGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGJ1dHRvbkRpc2FibGUgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgdGhpcy5fYnV0dG9uRWwuY2xhc3NMaXN0LmFkZChidXR0b25EaXNhYmxlKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9O1xyXG5cclxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXRFbCwgZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgc3BhbkVycm9yQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC5maWVsZHNldF9fZXJyb3ItdHlwZS0ke2lucHV0RWwuaWR9YFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHNwYW5FcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXRFbCkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIHNwYW5FcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuZmllbGRzZXRfX2Vycm9yLXR5cGUtJHtpbnB1dEVsLmlkfWBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzcGFuRXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSA9ICgpID0+XHJcbiAgICB0aGlzLl9hbGxJbnB1dHMuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcblxyXG4gIF90b2dnbGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBjb25zdCB7IGJ1dHRvbkRpc2FibGUgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgY29uc3QgaXNJbnB1dHNWYWxpZCA9IHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KCk7XHJcblxyXG4gICAgaWYgKGlzSW5wdXRzVmFsaWQpIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuICBfaGFuZGxlT3ZlcmxheSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVPdmVybGF5KTtcclxuICAgIHRoaXMuX3BvcHVwXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm0gPSBoYW5kbGVGb3JtO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5maWVsZHNldF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLmZpZWxkc2V0X19pbnB1dFwiKSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgY29uc3Qga2V5ID0gaW5wdXQubmFtZTtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgdmFsdWVzW2tleV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCB2YWx1ZXNGcm9tRm9ybSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcblxyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtKHZhbHVlc0Zyb21Gb3JtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XHJcbmNvbnN0IGdhbGxlcnlXcmFwID0gXCIuZ2FsbGVyeVwiO1xyXG5jb25zdCBhdmF0YXJQb3B1cCA9IFwiLnBvcHVwX3R5cGVfYXZhdGFyXCI7XHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IFwiLnBvcHVwX3R5cGVfY2FyZFwiO1xyXG5jb25zdCBwcm9maWxlUG9wdXAgPSBcIi5wb3B1cF90eXBlX3Byb2ZpbGVcIjtcclxuY29uc3Qgb3BlbkltZ1ZpZXcgPSBcIi5wb3B1cF90eXBlX3pvb21cIjtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZm9ybXMuZm9ybVByb2ZpbGUuZWxlbWVudHMubmFtZTtcclxuY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LmZvcm1zLmZvcm1Qcm9maWxlLmVsZW1lbnRzLmFib3V0O1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LmZvcm1zLmZvcm1BdmF0YXIuZWxlbWVudHMubGluaztcclxuY29uc3QgdGVtcGxhdGVTZWxlY3RvciA9IFwiI2dhbGxlcnlfX2l0ZW1cIjtcclxuY29uc3QgcHJvZmlsZVNwYW5BcnJheSA9IHtcclxuICBuYW1lOiBcIi50ZXh0X19uYW1lXCIsXHJcbiAgYWJvdXQ6IFwiLnRleHRfX2Fib3V0XCIsXHJcbiAgYXZhdGFyOiBcIi50b3BfX2ltZ1wiLFxyXG59O1xyXG5cclxuY29uc3Qgb3BlblByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGV4dF9fZWRpdFwiKTtcclxuY29uc3Qgb3BlbkltZ0FkZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3BfX3BsdXMtYm94XCIpO1xyXG5jb25zdCBvcGVuQXZhdGFyUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvcF9fY29udGFpbmVyLWltYWdlXCIpO1xyXG4vL3NldHRpbmdzXHJcbmNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZpZWxkc2V0X19pbnB1dFwiLFxyXG4gIGJ1dHRvblNlbGVjdG9yOiBcIi5maWVsZHNldF9fYnV0dG9uXCIsXHJcbiAgYnV0dG9uRGlzYWJsZTogXCJmaWVsZHNldF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZpZWxkc2V0X19pbnB1dF9lcnJvclwiLFxyXG4gIHNwYW5FcnJvckNsYXNzOiBcImZpZWxkc2V0X19lcnJvci1tZXNzYWdlLWFjdGl2ZVwiLFxyXG59O1xyXG5sZXQgdXNlcklkO1xyXG5sZXQgc2VjdGlvbk5ldyA9IFwiXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI2ZWZiNzE1Zi0zZjI3LTQ3YWEtYjExYi0wMGQ0NzZiYjgwYTJcIixcclxuXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgZ2FsbGVyeVdyYXAsXHJcbiAgYXZhdGFyUG9wdXAsXHJcbiAgYWRkQ2FyZFBvcHVwLFxyXG4gIHByb2ZpbGVQb3B1cCxcclxuICBvcGVuSW1nVmlldyxcclxuICBuYW1lSW5wdXQsXHJcbiAgYWJvdXRJbnB1dCxcclxuICBhdmF0YXJJbnB1dCxcclxuICB0ZW1wbGF0ZVNlbGVjdG9yLFxyXG4gIHByb2ZpbGVTcGFuQXJyYXksXHJcbiAgb3BlbkF2YXRhclBvcHVwLFxyXG4gIG9wZW5Qcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ0FkZFBvcHVwLFxyXG4gIHNldHRpbmdzLFxyXG4gIHVzZXJJZCxcclxuICBzZWN0aW9uTmV3LFxyXG4gIGFwaSxcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IHNldHRpbmdzLmJhc2VVcmw7XHJcbiAgfVxyXG4gIF9oZWFkZXJzKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCI2ZWZiNzE1Zi0zZjI3LTQ3YWEtYjExYi0wMGQ0NzZiYjgwYTJcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICB9O1xyXG4gIH1cclxuICBfY3VzdG9tRmV0Y2godXJsLCBoZWFkZXJzKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBoZWFkZXJzKS50aGVuKChyZXMpID0+XHJcbiAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dClcclxuICAgICk7XHJcbiAgfVxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzKCksXHJcbiAgICB9KTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMoKSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMoKSxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycygpLFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdEF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMoKSxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzKCksXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycygpLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxpa2VDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMoKSxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXRcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5cclxuaW1wb3J0IHtcclxuICBnYWxsZXJ5V3JhcCxcclxuICBhdmF0YXJQb3B1cCxcclxuICBhZGRDYXJkUG9wdXAsXHJcbiAgcHJvZmlsZVBvcHVwLFxyXG4gIG9wZW5JbWdWaWV3LFxyXG4gIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgcHJvZmlsZVNwYW5BcnJheSxcclxuICBvcGVuQXZhdGFyUG9wdXAsXHJcbiAgb3BlblByb2ZpbGVQb3B1cCxcclxuICBvcGVuSW1nQWRkUG9wdXAsXHJcbiAgc2V0dGluZ3MsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGFib3V0SW5wdXQsXHJcbiAgYXZhdGFySW5wdXQsXHJcbiAgYXBpLFxyXG59IGZyb20gXCIuLi91dGlsaXRpZXMvY29uc3RhbnRzXCI7XHJcblxyXG5jb25zdCBjb25maXJtUG9wdXAgPSBuZXcgUG9wdXBXaXRoU3VibWl0KFwiLnBvcHVwX3R5cGVfZGVsZXRlXCIpO1xyXG5cclxuY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKChkYXRhKSA9PiB7XHJcbiAgcmVuZGVyQ2FyZChkYXRhKTtcclxufSwgZ2FsbGVyeVdyYXApO1xyXG5cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQoZGF0YSkpO1xyXG59O1xyXG5cclxuLy9mdW5jdGlvbnMvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8ocHJvZmlsZVNwYW5BcnJheSk7XHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzRGF0YV0pID0+IHtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZUlucHV0OiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICBhYm91dElucHV0OiB1c2VyRGF0YS5hYm91dCxcclxuICAgIH0pO1xyXG4gICAgdXNlckluZm8uc2V0QXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICBzZWN0aW9uLnJlbmRlckluaXRpYWxJdGVtcyhjYXJkc0RhdGEpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSk7XHJcblxyXG5jb25zdCBzdWJtaXRQcm9maWxlRm9ybUlucHV0cyA9IChkYXRhKSA9PiB7XHJcbiAgcHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyh0cnVlLCBcIiBBZGRpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8oeyBuYW1lOiBkYXRhLm5hbWUsIGFib3V0OiBkYXRhLmFib3V0LCBhdmF0YXI6IGRhdGEuYXZhdGFyIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZUlucHV0OiBkYXRhLm5hbWUsXHJcbiAgICAgICAgYWJvdXRJbnB1dDogZGF0YS5hYm91dCxcclxuICAgICAgICBhdmF0YXJJbnB1dDogZGF0YS5hdmF0YXIsXHJcbiAgICAgIH0pO1xyXG4gICAgICBwcm9maWxlRm9ybS5jbG9zZSgpO1xyXG4gICAgICB1c2VySW5mby5zZXRBdmF0YXJJbmZvKGRhdGEuYXZhdGFyKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIHVzZXJJZCxcclxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgfSxcclxuICAgIChpZCkgPT4ge1xyXG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kaXNsaWtlQ2FyZChpZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmxpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICAoY2FyZElkKSA9PiB7XHJcbiAgICAgIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XHJcbiAgICAgIGNvbmZpcm1Qb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGNvbmZpcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgICBjb25maXJtUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25maXJtUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5jcmVhdGVDYXJkKCk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKGFkZENhcmRQb3B1cCwgKGRhdGEpID0+IHtcclxuICBhZGRDYXJkRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUsIFwiU2F2aW5nLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLmxpbmsgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZChyZXMsIGdhbGxlcnlXcmFwKTtcclxuICAgICAgYWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhZGRDYXJkRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1cIikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm1FbCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHJlc2V0QXZhdGFyRm9ybVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybUF2YXRhci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxufTtcclxuY29uc3QgcmVzZXRJbWdBZGRGb3JtID0gKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm1JbWcuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XHJcbiAgcHJvZmlsZUF2YXRhci5yZW5kZXJMb2FkaW5nKHRydWUsIFwiQ2hhbmdpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhcihkYXRhLnVybClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVBdmF0YXIucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtSW5wdXRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBhYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XHJcbn07XHJcblxyXG5jb25zdCByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tmb3JtUHJvZmlsZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1JbnB1dHMocHJvZmlsZURhdGEpO1xyXG4gIHByb2ZpbGVGb3JtLm9wZW4oKTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vY2xhc3Nlcy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uob3BlbkltZ1ZpZXcpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlUG9wdXAsIHN1Ym1pdFByb2ZpbGVGb3JtSW5wdXRzKTtcclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShhdmF0YXJQb3B1cCwgKGRhdGEpID0+IHtcclxuICBoYW5kbGVBdmF0YXJTdWJtaXQoZGF0YSk7XHJcbiAgcHJvZmlsZUF2YXRhci5jbG9zZSgpO1xyXG59KTtcclxuXHJcbi8vbGlzdGVuZXJzLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbm9wZW5JbWdBZGRQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHJlc2V0SW1nQWRkRm9ybSgpO1xyXG5cclxuICBhZGRDYXJkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5hZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxub3BlblByb2ZpbGVQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHJlc2V0QW5kT3BlblByb2ZpbGVGb3JtKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxub3BlbkF2YXRhclBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcmVzZXRBdmF0YXJGb3JtVmFsaWRhdGlvbigpO1xyXG4gIHByb2ZpbGVBdmF0YXIub3BlbigpO1xyXG59KTtcclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIuZmllbGRzZXRfX2J1dHRvbi10eXBlLXNhdmVcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJEZWxldGluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoU3VibWl0O1xyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZW5kZXJlciwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySW5pdGlhbEl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhKSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5uYW1lKTtcclxuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5hYm91dCk7XHJcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkYXRhLmF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX3VzZXJBdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZUlucHV0LCBhYm91dElucHV0IH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gbmFtZUlucHV0O1xyXG4gICAgdGhpcy5fdXNlckFib3V0LnRleHRDb250ZW50ID0gYWJvdXRJbnB1dDtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcihhdmF0YXJJbnB1dCkge1xyXG4gICAgdGhpcy5fdXNlckF2YXRhci5zcmMgPSBhdmF0YXJJbnB1dDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltZ1wiKTtcclxuICB9XHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHtuYW1lfWA7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidXNlcklkIiwic2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVMaWtlQnV0dG9uIiwiaGFuZGxlRGVsZXRlIiwidGhpcyIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsIl9uYW1lIiwibmFtZSIsIl91c2VySWQiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lciIsIm93bmVyIiwiX2lkIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZSIsIl9hbHQiLCJfdGVtcGxhdGVFbGVtZW50IiwiaXNMaWtlZCIsInNvbWUiLCJsaWtlIiwiZ2V0SWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZGVsZXRlQ2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfbGlrZUNhcmQiLCJfZ2FsbGVyeUltZyIsIl9hZGRMaWtlIiwiY2xhc3NMaXN0IiwiYWRkIiwiX3JlbW92ZUxpa2UiLCJzZXRMaWtlcyIsIm5ld0xpa2VzIiwiY29uc29sZSIsImxvZyIsIl9yZW5kZXJMaWtlcyIsIl9oaWRlRGVsZXRlQnV0dG9uIiwic3R5bGUiLCJkaXNwbGF5IiwibGlrZXNBbW91bnQiLCJsZW5ndGgiLCJfY291bnRlckxpa2VzIiwidGV4dENvbnRlbnQiLCJfZ2VuZXJhdGVDYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImNyZWF0ZUNhcmQiLCJfZ2FsbGVyeVRleHQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9oaWRlQWxsRXJyb3JzIiwiX2Rpc2FibGVCdXR0b24iLCJfZm9ybUVsZW1lbnQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9hbGxJbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXRFbCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uIiwiaW5wdXQiLCJfaGlkZUlucHV0RXJyb3IiLCJidXR0b25EaXNhYmxlIiwiX3NldHRpbmdzIiwiX2J1dHRvbkVsIiwiZGlzYWJsZWQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJzcGFuRXJyb3JDbGFzcyIsIl9lcnJvckVsZW1lbnQiLCJpZCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsIl9lbmFibGVCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiYnV0dG9uU2VsZWN0b3IiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJ0YXJnZXQiLCJjb250YWlucyIsImNsb3NlIiwia2V5IiwiX3BvcHVwIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVPdmVybGF5IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm0iLCJzdXBlciIsIl9oYW5kbGVGb3JtIiwiX2Zvcm0iLCJfc3VibWl0QnV0dG9uIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwiX2dldElucHV0VmFsdWVzIiwidmFsdWVzIiwidmFsdWUiLCJ2YWx1ZXNGcm9tRm9ybSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsInJlc2V0IiwiZ2FsbGVyeVdyYXAiLCJuYW1lSW5wdXQiLCJmb3JtcyIsImZvcm1Qcm9maWxlIiwiZWxlbWVudHMiLCJhYm91dElucHV0IiwiYWJvdXQiLCJvcGVuUHJvZmlsZVBvcHVwIiwiZm9ybUF2YXRhciIsIm9wZW5JbWdBZGRQb3B1cCIsIm9wZW5BdmF0YXJQb3B1cCIsImFwaSIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsIl9jdXN0b21GZXRjaCIsInVybCIsImhlYWRlcnMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzVGV4dCIsImdldENhcmRzIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsImVkaXRBdmF0YXIiLCJhdmF0YXIiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiZGlzbGlrZUNhcmQiLCJsaWtlQ2FyZCIsImNvbmZpcm1Qb3B1cCIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9zdWJtaXRIYW5kbGVyIiwic2VjdGlvbiIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySW5pdGlhbEl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJyZW5kZXJDYXJkIiwidXNlckluZm8iLCJfdXNlck5hbWUiLCJfdXNlckFib3V0IiwiX3VzZXJBdmF0YXIiLCJzZXRBdmF0YXIiLCJhdmF0YXJJbnB1dCIsImFsbCIsInVzZXJEYXRhIiwiY2FyZHNEYXRhIiwiY2F0Y2giLCJlcnIiLCJjYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJyZW1vdmVDYXJkIiwiZmluYWxseSIsImFkZENhcmRGb3JtIiwidGl0bGUiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1FbCIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9jYXB0aW9uIiwiX2ltYWdlIiwicHJvZmlsZUZvcm0iLCJzZXRBdmF0YXJJbmZvIiwicHJvZmlsZUF2YXRhciIsImhhbmRsZUF2YXRhclN1Ym1pdCIsImZvcm1JbWciLCJyZXNldFZhbGlkYXRpb24iLCJoYW5kbGVQcm9maWxlRm9ybUlucHV0cyJdLCJzb3VyY2VSb290IjoiIn0=