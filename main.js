!function(){"use strict";class e{constructor(e,t,s,n,r,i){var o,a;a=()=>{this._cardElement.remove(),this._cardElement=null},(o="removeCard")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._name=e.name,this._userId=t,this._link=e.link,this._likes=e.likes,this._owner=e.owner._id,this._id=e._id,this._handleCardClick=n,this._handleLikeButton=r,this._handleDelete=i,this._alt="Photo of ".concat(e.name),this._templateElement=s}isLiked(){return this._likes.some((e=>e._id==this._userId))}getId(){return this._id}_setEventListeners(){this._deleteCard.addEventListener("click",(()=>this._handleDelete(this._id))),this._likeCard.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._galleryImg.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}_addLike(){this._likeCard.classList.add("button_liked")}_removeLike(){this._likeCard.classList.remove("button_liked")}setLikes(e){this._likes=e,this._renderLikes()}_hideDeleteButton(){this._owner!==this._userId&&(this._deleteCard.style.display="none")}_renderLikes(){this.isLiked()?this._addLike():this._removeLike();const e=this._likes.length;this._counterLikes.textContent=e}_generateCard(){return this._cardElement=document.querySelector(this._templateElement).content.querySelector(".gallery__item").cloneNode(!0)}createCard(){return this._cardElement=this._generateCard(),this._galleryImg=this._cardElement.querySelector(".gallery__img"),this._galleryText=this._cardElement.querySelector(".desc__text"),this._deleteCard=this._cardElement.querySelector(".gallery__bin"),this._likeCard=this._cardElement.querySelector(".like__button"),this._counterLikes=this._cardElement.querySelector(".like__counter"),this._galleryText.textContent=this._name,this._galleryImg.src=this._link,this._galleryImg.alt=this._alt,this._renderLikes(),this._hideDeleteButton(),this._setEventListeners(),this._cardElement}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s){t(this,"resetValidation",(()=>{this._hideAllErrors(),this._disableButton()})),t(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()})),t(this,"_setEventListeners",(()=>{this._allInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),t(this,"_hideAllErrors",(()=>{this._allInputs.forEach((e=>{this._hideInputError(e)}))})),t(this,"_disableButton",(()=>{const{buttonDisable:e}=this._settings;this._buttonEl.classList.add(e),this._buttonEl.disabled=!0})),t(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,spanErrorClass:n}=this._settings,r=this._formElement.querySelector(".fieldset__error-type-".concat(e.id));e.classList.add(s),r.textContent=t,r.classList.add(n)})),t(this,"_hideInputError",(e=>{const{inputErrorClass:t,spanErrorClass:s}=this._settings,n=this._formElement.querySelector(".fieldset__error-type-".concat(e.id));e.classList.remove(t),n.classList.remove(s),n.textContent=""})),t(this,"_checkFormValidity",(()=>this._allInputs.every((e=>e.validity.valid)))),t(this,"_toggleButton",(()=>{const{buttonDisable:e}=this._settings;this._checkFormValidity()?this._enableButton():this._disableButton()})),t(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),this._settings=e,this._formElement=s,this._allInputs=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonEl=this._formElement.querySelector(this._settings.buttonSelector)}_enableButton(){const{buttonDisable:e}=this._settings;this._buttonEl.classList.remove(e),this._buttonEl.disabled=!1}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){n(this,"_handleOverlay",(e=>{e.target.classList.contains("popup")&&this.close()})),n(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",this._handleOverlay),this._popup.querySelector(".popup__close").addEventListener("mousedown",(()=>this.close()))}}class i extends r{constructor(e,t){super(e),this._handleForm=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button"),this._submitButtonText=this._submitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".fieldset__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,n=t.value;e[s]=n})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleForm(t)}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}close(){super.close(),this._form.reset()}}const o=".gallery",a=document.forms.formProfile.elements.name,l=document.forms.formProfile.elements.about,h=(document.forms.formAvatar.elements.link,document.querySelector(".text__edit")),c=document.querySelector(".top__plus-box"),d=document.querySelector(".top__container-image"),_={inputSelector:".fieldset__input",buttonSelector:".fieldset__button",buttonDisable:"fieldset__button_disabled",inputErrorClass:"fieldset__input_error",spanErrorClass:"fieldset__error-message-active"},u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkAndConvertRes(e){return e.ok?e.json():Promise.reject(e.status)}getCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkAndConvertRes)}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkAndConvertRes)}setUserInfo(e){let{name:t,about:s}=e;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})}).then(this._checkAndConvertRes)}addCard(e){let{name:t,link:s}=e;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:s})}).then(this._checkAndConvertRes)}editAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._checkAndConvertRes)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkAndConvertRes)}dislikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"}).then(this._checkAndConvertRes)}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"}).then(this._checkAndConvertRes)}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}}),m=new class extends r{constructor(e){super(e),this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button-type-save"),this._submitButtonText=this._submitButton.textContent}setAction(e){this._submitHandler=e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitButton.textContent=e?t:this._submitButtonText}}(".popup_type_delete");let p;m.setEventListeners();const b=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}renderInitialItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}((e=>{g(e)}),o),g=e=>{b.addItem(f(e))},v=new class{constructor(e){this._userName=document.querySelector(e.name),this._userAbout=document.querySelector(e.about),this._userAvatar=document.querySelector(e.avatar)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent,avatar:this._userAvatar.src}}setUserInfo(e){let{nameInput:t,aboutInput:s}=e;this._userName.textContent=t,this._userAbout.textContent=s}setAvatar(e){this._userAvatar.src=e}}({name:".text__name",about:".text__about",avatar:".top__img"});Promise.all([u.getUserInfo(),u.getCards()]).then((e=>{let[t,s]=e;p=t._id,v.setUserInfo({nameInput:t.name,aboutInput:t.about}),v.setAvatar(t.avatar),b.renderInitialItems(s)})).catch((e=>console.log("Error somthing went wrong. ".concat(e))));const f=t=>{const s=new e(t,p,"#gallery__item",((e,t)=>{k.open(e,t)}),(e=>{s.isLiked()?u.dislikeCard(e).then((e=>{s.setLikes(e.likes)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))):u.likeCard(e).then((e=>{s.setLikes(e.likes)})).catch((e=>console.log("Error somthing went wrong. ".concat(e))))}),(e=>{m.open(),m.setAction((()=>{m.renderLoading(!0,"Deleting..."),u.deleteCard(e).then((e=>{s.removeCard(),m.close()})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{m.renderLoading(!1)}))}))}));return s.createCard()},E=new i(".popup_type_card",(e=>{E.renderLoading(!0,"Saving..."),u.addCard({name:e.title,link:e.link}).then((e=>{g(e,o),E.close()})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{E.renderLoading(!1)}))})),y={};Array.from(document.querySelectorAll(".form")).forEach((e=>{const t=new s(_,e),n=e.getAttribute("name");y[n]=t,t.enableValidation()}));const k=new class extends r{constructor(e){super(e),this._popup=document.querySelector(e),this._caption=this._popup.querySelector(".popup__caption"),this._image=this._popup.querySelector(".popup__img")}open(e,t){this._caption.textContent=e,this._image.src=t,this._image.alt="Photo of ".concat(e),super.open()}}(".popup_type_zoom");k.setEventListeners();const L=new i(".popup_type_profile",(e=>{L.renderLoading(!0," Adding..."),u.setUserInfo({name:e.name,about:e.about,avatar:e.avatar}).then((e=>{v.setUserInfo({nameInput:e.name,aboutInput:e.about,avatarInput:e.avatar}),L.close(),v.setAvatarInfo(e.avatar)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{L.renderLoading(!1)}))}));L.setEventListeners();const C=new i(".popup_type_avatar",(e=>{(e=>{C.renderLoading(!0,"Changing..."),u.editAvatar(e.url).then((e=>{v.setAvatar(e.avatar)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{C.renderLoading(!1)}))})(e),C.close()}));c.addEventListener("click",(()=>{y[formImg.getAttribute("name")].resetValidation(),E.open()})),E.setEventListeners(),h.addEventListener("click",(()=>{y[formProfile.getAttribute("name")].resetValidation(),v.getUserInfo(),(()=>{const{name:e,about:t}=v.getUserInfo();a.value=e,l.value=t})(),L.open()})),C.setEventListeners(),d.addEventListener("click",(()=>{y[formAvatar.getAttribute("name")].resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUl0RyxFRjNMTixzQkUyTGtDdEcsSUFyQzFCQSxLQUMxQjRNLEVBQWN4RixlQUFjLEVBQU0sZUFDbENlLEVBQUFBLFdBQ2NuSSxFQUFLNk0sS0FDaEI1RCxNQUFNUixJQUNMc0MsRUFBU0ksVUFBVTFDLEVBQUlpQixPQUF2QixJQUVEOEIsT0FBT0MsR0FBUUMsUUFBUUMsSUFBUixxQ0FBMENGLE1BQ3pETSxTQUFRLEtBQ1BhLEVBQWN4RixlQUFjLEVBQTVCLEdBUEosRUFvQ0EwRixDQUFtQjlNLEdBQ25CNE0sRUFBYzlHLE9BQWQsSUFNRm1DLEVBQWdCbkcsaUJBQWlCLFNBQVMsS0EvQ3hDb0ssRUFBZWEsUUFBUVQsYUFBYSxTQUFTVSxrQkFrRDdDaEIsRUFBWS9GLE1BQVosSUFFRitGLEVBQVk1RixvQkFFWjJCLEVBQWlCakcsaUJBQWlCLFNBQVMsS0FoQ3pDb0ssRUFBZXZFLFlBQVkyRSxhQUFhLFNBQVNVLGtCQUM3QmpDLEVBQVM3QixjQVJDLE1BQzlCLE1BQU0sS0FBRXhJLEVBQUYsTUFBUW9ILEdBQVVpRCxFQUFTN0IsY0FDakN6QixFQUFVUCxNQUFReEcsRUFDbEJtSCxFQUFXWCxNQUFRWSxDQUFuQixFQU1BbUYsR0FDQVAsRUFBWXpHLE1BOEJhLElBRzNCMkcsRUFBY3hHLG9CQUVkOEIsRUFBZ0JwRyxpQkFBaUIsU0FBUyxLQS9EeENvSyxFQUFlbEUsV0FBV3NFLGFBQWEsU0FBU1Usa0JBaUVoREosRUFBYzNHLE1BQWQsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxpdGllcy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgc2VsZWN0b3IsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uLFxyXG4gICAgaGFuZGxlRGVsZXRlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGUgPSBoYW5kbGVEZWxldGU7XHJcbiAgICB0aGlzLl9hbHQgPSBgUGhvdG8gb2YgJHtkYXRhLm5hbWV9YDtcclxuICAgIHRoaXMuX3RlbXBsYXRlRWxlbWVudCA9IHNlbGVjdG9yO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PSB0aGlzLl91c2VySWQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9saWtlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZClcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2FkZExpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QuYWRkKFwiYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUxpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXMobmV3TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuICBfaGlkZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIGlmICh0aGlzLl9vd25lciAhPT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfVxyXG4gIH1cclxuICBfcmVuZGVyTGlrZXMoKSB7XHJcbiAgICBpZiAodGhpcy5pc0xpa2VkKCkpIHtcclxuICAgICAgdGhpcy5fYWRkTGlrZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fcmVtb3ZlTGlrZSgpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbGlrZXNBbW91bnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9jb3VudGVyTGlrZXMudGV4dENvbnRlbnQgPSBsaWtlc0Ftb3VudDtcclxuICB9XHJcbiAgX2dlbmVyYXRlQ2FyZCgpIHtcclxuICAgIHJldHVybiAodGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZUVsZW1lbnQpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faXRlbVwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpKTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dlbmVyYXRlQ2FyZCgpO1xyXG4gICAgdGhpcy5fZ2FsbGVyeUltZyA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9faW1nXCIpO1xyXG4gICAgdGhpcy5fZ2FsbGVyeVRleHQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlc2NfX3RleHRcIik7XHJcbiAgICB0aGlzLl9kZWxldGVDYXJkID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19iaW5cIik7XHJcbiAgICB0aGlzLl9saWtlQ2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlrZV9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY291bnRlckxpa2VzID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlX19jb3VudGVyXCIpO1xyXG4gICAgdGhpcy5fZ2FsbGVyeVRleHQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5hbHQgPSB0aGlzLl9hbHQ7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gICAgdGhpcy5faGlkZURlbGV0ZUJ1dHRvbigpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fYWxsSW5wdXRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLl9idXR0b25FbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLmJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5faGlkZUFsbEVycm9ycygpO1xyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fYWxsSW5wdXRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBfaGlkZUFsbEVycm9ycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2FsbElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IGJ1dHRvbkRpc2FibGUgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgdGhpcy5fYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShidXR0b25EaXNhYmxlKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG4gIF9kaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5hZGQoYnV0dG9uRGlzYWJsZSk7XHJcbiAgICB0aGlzLl9idXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfTtcclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWwsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIHNwYW5FcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuZmllbGRzZXRfX2Vycm9yLXR5cGUtJHtpbnB1dEVsLmlkfWBcclxuICAgICk7XHJcblxyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChzcGFuRXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBzcGFuRXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLmZpZWxkc2V0X19lcnJvci10eXBlLSR7aW5wdXRFbC5pZH1gXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc3BhbkVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9O1xyXG5cclxuICBfY2hlY2tGb3JtVmFsaWRpdHkgPSAoKSA9PlxyXG4gICAgdGhpcy5fYWxsSW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGlzSW5wdXRzVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xyXG5cclxuICAgIGlmIChpc0lucHV0c1ZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcbiAgX2hhbmRsZU92ZXJsYXkgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlT3ZlcmxheSk7XHJcbiAgICB0aGlzLl9wb3B1cFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtID0gaGFuZGxlRm9ybTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZmllbGRzZXRfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5maWVsZHNldF9faW5wdXRcIikpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgdmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0Lm5hbWU7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgIHZhbHVlc1trZXldID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB2YWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdmFsdWVzRnJvbUZvcm0gPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybSh2YWx1ZXNGcm9tRm9ybSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5jb25zdCBnYWxsZXJ5V3JhcCA9IFwiLmdhbGxlcnlcIjtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBcIi5wb3B1cF90eXBlX2F2YXRhclwiO1xyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBcIi5wb3B1cF90eXBlX2NhcmRcIjtcclxuY29uc3QgcHJvZmlsZVBvcHVwID0gXCIucG9wdXBfdHlwZV9wcm9maWxlXCI7XHJcbmNvbnN0IG9wZW5JbWdWaWV3ID0gXCIucG9wdXBfdHlwZV96b29tXCI7XHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmZvcm1zLmZvcm1Qcm9maWxlLmVsZW1lbnRzLm5hbWU7XHJcbmNvbnN0IGFib3V0SW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtUHJvZmlsZS5lbGVtZW50cy5hYm91dDtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtQXZhdGFyLmVsZW1lbnRzLmxpbms7XHJcbmNvbnN0IHRlbXBsYXRlU2VsZWN0b3IgPSBcIiNnYWxsZXJ5X19pdGVtXCI7XHJcbmNvbnN0IHByb2ZpbGVTcGFuQXJyYXkgPSB7XHJcbiAgbmFtZTogXCIudGV4dF9fbmFtZVwiLFxyXG4gIGFib3V0OiBcIi50ZXh0X19hYm91dFwiLFxyXG4gIGF2YXRhcjogXCIudG9wX19pbWdcIixcclxufTtcclxuXHJcbmNvbnN0IG9wZW5Qcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRleHRfX2VkaXRcIik7XHJcbmNvbnN0IG9wZW5JbWdBZGRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9wX19wbHVzLWJveFwiKTtcclxuY29uc3Qgb3BlbkF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3BfX2NvbnRhaW5lci1pbWFnZVwiKTtcclxuLy9zZXR0aW5nc1xyXG5jb25zdCBzZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5maWVsZHNldF9faW5wdXRcIixcclxuICBidXR0b25TZWxlY3RvcjogXCIuZmllbGRzZXRfX2J1dHRvblwiLFxyXG4gIGJ1dHRvbkRpc2FibGU6IFwiZmllbGRzZXRfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmaWVsZHNldF9faW5wdXRfZXJyb3JcIixcclxuICBzcGFuRXJyb3JDbGFzczogXCJmaWVsZHNldF9fZXJyb3ItbWVzc2FnZS1hY3RpdmVcIixcclxufTtcclxubGV0IHVzZXJJZDtcclxubGV0IHNlY3Rpb25OZXcgPSBcIlwiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcblxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNmVmYjcxNWYtM2YyNy00N2FhLWIxMWItMDBkNDc2YmI4MGEyXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgZ2FsbGVyeVdyYXAsXHJcbiAgYXZhdGFyUG9wdXAsXHJcbiAgYWRkQ2FyZFBvcHVwLFxyXG4gIHByb2ZpbGVQb3B1cCxcclxuICBvcGVuSW1nVmlldyxcclxuICBuYW1lSW5wdXQsXHJcbiAgYWJvdXRJbnB1dCxcclxuICBhdmF0YXJJbnB1dCxcclxuICB0ZW1wbGF0ZVNlbGVjdG9yLFxyXG4gIHByb2ZpbGVTcGFuQXJyYXksXHJcbiAgb3BlbkF2YXRhclBvcHVwLFxyXG4gIG9wZW5Qcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ0FkZFBvcHVwLFxyXG4gIHNldHRpbmdzLFxyXG4gIHVzZXJJZCxcclxuICBzZWN0aW9uTmV3LFxyXG4gIGFwaSxcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcbiAgX2NoZWNrQW5kQ29udmVydFJlcyhyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja0FuZENvbnZlcnRSZXMpO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tBbmRDb252ZXJ0UmVzKTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgYWJvdXQ6IGFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tBbmRDb252ZXJ0UmVzKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrQW5kQ29udmVydFJlcyk7XHJcbiAgfVxyXG5cclxuICBlZGl0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrQW5kQ29udmVydFJlcyk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja0FuZENvbnZlcnRSZXMpO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja0FuZENvbnZlcnRSZXMpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja0FuZENvbnZlcnRSZXMpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0XCI7XHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgZ2FsbGVyeVdyYXAsXHJcbiAgYXZhdGFyUG9wdXAsXHJcbiAgYWRkQ2FyZFBvcHVwLFxyXG4gIHByb2ZpbGVQb3B1cCxcclxuICBvcGVuSW1nVmlldyxcclxuICB0ZW1wbGF0ZVNlbGVjdG9yLFxyXG4gIHByb2ZpbGVTcGFuQXJyYXksXHJcbiAgb3BlbkF2YXRhclBvcHVwLFxyXG4gIG9wZW5Qcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ0FkZFBvcHVwLFxyXG4gIHNldHRpbmdzLFxyXG4gIG5hbWVJbnB1dCxcclxuICBhYm91dElucHV0LFxyXG4gIGF2YXRhcklucHV0LFxyXG4gIGFwaSxcclxufSBmcm9tIFwiLi4vdXRpbGl0aWVzL2NvbnN0YW50c1wiO1xyXG5cclxuY29uc3QgY29uZmlybVBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5wb3B1cF90eXBlX2RlbGV0ZVwiKTtcclxuXHJcbmNvbmZpcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxubGV0IHVzZXJJZDtcclxuXHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbigoZGF0YSkgPT4ge1xyXG4gIHJlbmRlckNhcmQoZGF0YSk7XHJcbn0sIGdhbGxlcnlXcmFwKTtcclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIHNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGEpKTtcclxufTtcclxuXHJcbi8vZnVuY3Rpb25zLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVTcGFuQXJyYXkpO1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc0RhdGFdKSA9PiB7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWVJbnB1dDogdXNlckRhdGEubmFtZSxcclxuICAgICAgYWJvdXRJbnB1dDogdXNlckRhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIHVzZXJJbmZvLnNldEF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgc2VjdGlvbi5yZW5kZXJJbml0aWFsSXRlbXMoY2FyZHNEYXRhKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpO1xyXG5cclxuY29uc3Qgc3VibWl0UHJvZmlsZUZvcm1JbnB1dHMgPSAoZGF0YSkgPT4ge1xyXG4gIHByb2ZpbGVGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCIgQWRkaW5nLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLnNldFVzZXJJbmZvKHsgbmFtZTogZGF0YS5uYW1lLCBhYm91dDogZGF0YS5hYm91dCwgYXZhdGFyOiBkYXRhLmF2YXRhciB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWVJbnB1dDogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0SW5wdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgICAgYXZhdGFySW5wdXQ6IGRhdGEuYXZhdGFyLFxyXG4gICAgICB9KTtcclxuICAgICAgcHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFySW5mbyhkYXRhLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGRhdGEsXHJcbiAgICB1c2VySWQsXHJcbiAgICB0ZW1wbGF0ZVNlbGVjdG9yLFxyXG4gICAgKG5hbWUsIGxpbmspID0+IHtcclxuICAgICAgcG9wdXBXaXRoSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcclxuICAgIH0sXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGlzbGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5saWtlQ2FyZChpZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICBjb25maXJtUG9wdXAub3BlbigpO1xyXG4gICAgICBjb25maXJtUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBjb25maXJtUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIkRlbGV0aW5nLi4uXCIpO1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICAgICAgY29uZmlybVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSlcclxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgY29uZmlybVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuY3JlYXRlQ2FyZCgpO1xyXG59O1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShhZGRDYXJkUG9wdXAsIChkYXRhKSA9PiB7XHJcbiAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHsgbmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5saW5rIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzLCBnYWxsZXJ5V3JhcCk7XHJcbiAgICAgIGFkZENhcmRGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtXCIpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWwpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWwuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCByZXNldEF2YXRhckZvcm1WYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm1BdmF0YXIuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn07XHJcbmNvbnN0IHJlc2V0SW1nQWRkRm9ybSA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tmb3JtSW1nLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59O1xyXG5jb25zdCBoYW5kbGVBdmF0YXJTdWJtaXQgPSAoZGF0YSkgPT4ge1xyXG4gIHByb2ZpbGVBdmF0YXIucmVuZGVyTG9hZGluZyh0cnVlLCBcIkNoYW5naW5nLi4uXCIpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXIoZGF0YS51cmwpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlQXZhdGFyLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVQcm9maWxlRm9ybUlucHV0cyA9ICgpID0+IHtcclxuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgYWJvdXRJbnB1dC52YWx1ZSA9IGFib3V0O1xyXG59O1xyXG5cclxuY29uc3QgcmVzZXRBbmRPcGVuUHJvZmlsZUZvcm0gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybVByb2ZpbGUuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY29uc3QgcHJvZmlsZURhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGhhbmRsZVByb2ZpbGVGb3JtSW5wdXRzKHByb2ZpbGVEYXRhKTtcclxuICBwcm9maWxlRm9ybS5vcGVuKCk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vL2NsYXNzZXMvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKG9wZW5JbWdWaWV3KTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocHJvZmlsZVBvcHVwLCBzdWJtaXRQcm9maWxlRm9ybUlucHV0cyk7XHJcbnByb2ZpbGVGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcm9maWxlQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oYXZhdGFyUG9wdXAsIChkYXRhKSA9PiB7XHJcbiAgaGFuZGxlQXZhdGFyU3VibWl0KGRhdGEpO1xyXG4gIHByb2ZpbGVBdmF0YXIuY2xvc2UoKTtcclxufSk7XHJcblxyXG4vL2xpc3RlbmVycy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5vcGVuSW1nQWRkUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEltZ0FkZEZvcm0oKTtcclxuXHJcbiAgYWRkQ2FyZEZvcm0ub3BlbigpO1xyXG59KTtcclxuYWRkQ2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbm9wZW5Qcm9maWxlUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSgpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVBdmF0YXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbm9wZW5BdmF0YXJQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHJlc2V0QXZhdGFyRm9ybVZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlQXZhdGFyLm9wZW4oKTtcclxufSk7XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmZpZWxkc2V0X19idXR0b24tdHlwZS1zYXZlXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gYWN0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiRGVsZXRpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aFN1Ym1pdDtcclxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgLy8gdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckluaXRpYWxJdGVtcyhpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEubmFtZSk7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuYWJvdXQpO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5hdmF0YXIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgYWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl91c2VyQXZhdGFyLnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWVJbnB1dCwgYWJvdXRJbnB1dCB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWVJbnB1dDtcclxuICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IGFib3V0SW5wdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoYXZhdGFySW5wdXQpIHtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFySW5wdXQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWdcIik7XHJcbiAgfVxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsInNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUJ1dHRvbiIsImhhbmRsZURlbGV0ZSIsInRoaXMiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJfbmFtZSIsIm5hbWUiLCJfdXNlcklkIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXIiLCJvd25lciIsIl9pZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGUiLCJfYWx0IiwiX3RlbXBsYXRlRWxlbWVudCIsImlzTGlrZWQiLCJzb21lIiwibGlrZSIsImdldElkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2RlbGV0ZUNhcmQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VDYXJkIiwiX2dhbGxlcnlJbWciLCJfYWRkTGlrZSIsImNsYXNzTGlzdCIsImFkZCIsIl9yZW1vdmVMaWtlIiwic2V0TGlrZXMiLCJuZXdMaWtlcyIsIl9yZW5kZXJMaWtlcyIsIl9oaWRlRGVsZXRlQnV0dG9uIiwic3R5bGUiLCJkaXNwbGF5IiwibGlrZXNBbW91bnQiLCJsZW5ndGgiLCJfY291bnRlckxpa2VzIiwidGV4dENvbnRlbnQiLCJfZ2VuZXJhdGVDYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImNyZWF0ZUNhcmQiLCJfZ2FsbGVyeVRleHQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9oaWRlQWxsRXJyb3JzIiwiX2Rpc2FibGVCdXR0b24iLCJfZm9ybUVsZW1lbnQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9hbGxJbnB1dHMiLCJmb3JFYWNoIiwiaW5wdXRFbCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlQnV0dG9uIiwiaW5wdXQiLCJfaGlkZUlucHV0RXJyb3IiLCJidXR0b25EaXNhYmxlIiwiX3NldHRpbmdzIiwiX2J1dHRvbkVsIiwiZGlzYWJsZWQiLCJlcnJvck1lc3NhZ2UiLCJpbnB1dEVycm9yQ2xhc3MiLCJzcGFuRXJyb3JDbGFzcyIsImVycm9yRWxlbWVudCIsImlkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2VuYWJsZUJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJidXR0b25TZWxlY3RvciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2UiLCJrZXkiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZU92ZXJsYXkiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybSIsInN1cGVyIiwiX2hhbmRsZUZvcm0iLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9pbnB1dHMiLCJBcnJheSIsImZyb20iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInZhbHVlc0Zyb21Gb3JtIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwicmVzZXQiLCJnYWxsZXJ5V3JhcCIsIm5hbWVJbnB1dCIsImZvcm1zIiwiZm9ybVByb2ZpbGUiLCJlbGVtZW50cyIsImFib3V0SW5wdXQiLCJhYm91dCIsIm9wZW5Qcm9maWxlUG9wdXAiLCJmb3JtQXZhdGFyIiwib3BlbkltZ0FkZFBvcHVwIiwib3BlbkF2YXRhclBvcHVwIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrQW5kQ29udmVydFJlcyIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRDYXJkcyIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImRpc2xpa2VDYXJkIiwibGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY29uZmlybVBvcHVwIiwic2V0QWN0aW9uIiwiYWN0aW9uIiwiX3N1Ym1pdEhhbmRsZXIiLCJzZWN0aW9uIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJbml0aWFsSXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsInJlbmRlckNhcmQiLCJ1c2VySW5mbyIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfdXNlckF2YXRhciIsInNldEF2YXRhciIsImF2YXRhcklucHV0IiwiYWxsIiwidXNlckRhdGEiLCJjYXJkc0RhdGEiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJjYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJyZW1vdmVDYXJkIiwiZmluYWxseSIsImFkZENhcmRGb3JtIiwidGl0bGUiLCJmb3JtVmFsaWRhdG9ycyIsImZvcm1FbCIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsIl9jYXB0aW9uIiwiX2ltYWdlIiwicHJvZmlsZUZvcm0iLCJzZXRBdmF0YXJJbmZvIiwicHJvZmlsZUF2YXRhciIsInVybCIsImhhbmRsZUF2YXRhclN1Ym1pdCIsImZvcm1JbWciLCJyZXNldFZhbGlkYXRpb24iLCJoYW5kbGVQcm9maWxlRm9ybUlucHV0cyJdLCJzb3VyY2VSb290IjoiIn0=