!function(){"use strict";class t{constructor(t,e,s,r,n,i){var o,a;a=()=>this._cardElement.remove(),(o="removeCard")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._name=t.name,this._userId=e,this._link=t.link,this._likes=t.likes,this._owner=t.owner._id,this._id=t._id,this._handleCardClick=r,this._handleLikeButton=n,this._handleDelete=i,this._alt="Photo of ".concat(t.name),this._templateElement=s}isLiked(){return this._likes.some((t=>t._id==this._userId))}getId(){return this._id}_setEventListeners(){this._deleteCard.addEventListener("click",(()=>this._handleDelete(this._id))),this._likeCard.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._galleryImg.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}addLike(){this._likeCard.classList.add("button_liked")}removeLike(){this._likeCard.classList.remove("button_liked")}setLikes(t){this._likes=t;const e=this._likes.length;this._cardElement.querySelector(".like__counter").textContent=e,this._owner!==this._userId&&(this._deleteCard.style.display="none")}_generateCard(){return this._cardElement=document.querySelector(this._templateElement).content.querySelector(".gallery__item").cloneNode(!0)}createCard(){return this._cardElement=this._generateCard(),this._galleryImg=this._cardElement.querySelector(".gallery__img"),this._galleryText=this._cardElement.querySelector(".desc__text"),this._deleteCard=this._cardElement.querySelector(".gallery__bin"),this._likeCard=this._cardElement.querySelector(".like__button"),this._galleryText.textContent=this._name,this._galleryImg.src=this._link,this._galleryImg.alt=this._alt,this.setLikes(this._likes),this._setEventListeners(),this.isLiked()?this.addLike():this.removeLike(),this._cardElement}}function e(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class s{constructor(t,s){e(this,"resetValidation",(()=>{this._hideAllErrors(),this._disableButton()})),e(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(t=>t.preventDefault())),this._setEventListeners()})),e(this,"_setEventListeners",(()=>{this._allInputs.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButton()}))}))})),e(this,"_hideAllErrors",(()=>{this._allInputs.forEach((t=>{this._hideInputError(t)}))})),e(this,"_disableButton",(()=>{const{buttonDisable:t}=this._settings;this._buttonEl.classList.add(t),this._buttonEl.disabled=!0})),e(this,"_showInputError",((t,e)=>{const{inputErrorClass:s,spanErrorClass:r}=this._settings;this._errorDynamicSpan=this._formElement.querySelector(".fieldset__error-type-".concat(t.id)),t.classList.add(s),this._errorDynamicSpan.textContent=e,this._errorDynamicSpan.classList.add(r)})),e(this,"_hideInputError",(t=>{const{inputErrorClass:e,spanErrorClass:s}=this._settings;this._errorDynamicSpan=this._formElement.querySelector(".fieldset__error-type-".concat(t.id)),t.classList.remove(e),this._errorDynamicSpan.classList.remove(s),this._errorDynamicSpan.textContent=""})),e(this,"_checkFormValidity",(()=>this._allInputs.every((t=>t.validity.valid)))),e(this,"_toggleButton",(()=>{const{buttonDisable:t}=this._settings;this._checkFormValidity()?this._enableButton():this._disableButton()})),e(this,"_checkInputValidity",(t=>{t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)})),this._settings=t,this._formElement=s,this._allInputs=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonEl=this._formElement.querySelector(this._settings.buttonSelector)}_enableButton(){const{buttonDisable:t}=this._settings;this._buttonEl.classList.remove(t),this._buttonEl.disabled=!1}}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class n{constructor(t){r(this,"_handleOverlay",(t=>{t.target.classList.contains("popup")&&this.close()})),r(this,"_handleEscClose",(t=>{"Escape"===t.key&&this.close()})),this._popup=document.querySelector(t)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",this._handleOverlay),this._popup.querySelector(".popup__close").addEventListener("mousedown",(()=>this.close()))}}class i extends n{constructor(t,e){super(t),this._handleForm=e,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button"),this._submitButtonText=this._submitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".fieldset__input"))}showLoading(){this._buttonText=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText.textContent}_getInputValues(){const t={};return this._inputs.forEach((e=>{const s=e.name,r=e.value;t[s]=r})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault();const e=this._getInputValues();this._handleForm(e)}))}renderLoading(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=t?e:this._submitButtonText}close(){super.close(),this._form.reset()}}const o=".gallery",a=document.forms.formProfile.elements.name,l=document.forms.formProfile.elements.about,h=(document.forms.formAvatar.elements.link,document.querySelector(".text__edit")),c=document.querySelector(".top__plus-box"),d=document.querySelector(".top__container-image"),_={inputSelector:".fieldset__input",buttonSelector:".fieldset__button",buttonDisable:"fieldset__button_disabled",inputErrorClass:"fieldset__input_error",spanErrorClass:"fieldset__error-message-active"},u=new class{constructor(t){this._baseUrl=t.baseUrl,this._headers=t.headers}_customFetch(t,e){return fetch(t,e).then((t=>t.ok?t.json():Promise.reject(t.statusText)))}getCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(t){let{name:e,about:s}=t;return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:s})})}addCard(t){let{name:e,link:s}=t;return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:e,link:s})})}editAvatar(t){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:t})})}deleteCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(t),{headers:this._headers,method:"DELETE"})}dislikeCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{headers:this._headers,method:"DELETE"})}likeCard(t){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(t),{headers:this._headers,method:"PUT"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}}),m=new class extends n{constructor(t){super(t),this.popup=document.querySelector(t)}setAction(t){this._submitHandler=t}setEventListeners(){this._popup.addEventListener("submit",(t=>{t.preventDefault(),this._submitHandler()})),super.setEventListeners()}}(".popup_type_delete");let p;m.setEventListeners();const b=new class{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderInitialItems(t){t.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.prepend(t)}}((t=>{g(t)}),o),g=t=>{b.addItem(E(t))},v=new class{constructor(t){this._userName=document.querySelector(t.name),this._userAbout=document.querySelector(t.about),this._userAvatar=document.querySelector(t.avatar)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent,avatar:this._userAvatar.src}}setUserInfo(t){let{nameInput:e,aboutInput:s}=t;this._userName.textContent=e,this._userAbout.textContent=s}setAvatar(t){this._userAvatar.src=t}}({name:".text__name",about:".text__about",avatar:".top__img"});Promise.all([u.getUserInfo(),u.getCards()]).then((t=>{let[e,s]=t;p=e._id,v.setUserInfo({nameInput:e.name,aboutInput:e.about}),v.setAvatar(e.avatar),b.renderInitialItems(s)})).catch((t=>console.log("Error somthing went wrong. ".concat(t))));const E=e=>{const s=new t(e,p,"#gallery__item",((t,e)=>{L.open(t,e)}),(t=>{s.isLiked()?u.dislikeCard(t).then((t=>{s.setLikes(t.likes),s.removeLike()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))):u.likeCard(t).then((t=>{s.setLikes(t.likes),s.addLike()})).catch((t=>console.log("Error somthing went wrong. ".concat(t))))}),(t=>{m.open(),m.setAction((()=>{u.deleteCard(t).then((t=>{s.removeCard(),m.close()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{}))}))}));return s.createCard()},y=new i(".popup_type_card",(t=>{y.renderLoading(!0,"Saving..."),u.addCard({name:t.title,link:t.link}).then((t=>{g(t,o),y.close()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{y.renderLoading(!1)}))})),f={};Array.from(document.querySelectorAll(".form")).forEach((t=>{const e=new s(_,t),r=t.getAttribute("name");f[r]=e,e.enableValidation()}));const L=new class extends n{constructor(t){super(t),this._popup=document.querySelector(t),this._caption=this._popup.querySelector(".popup__caption"),this._image=this._popup.querySelector(".popup__img")}open(t,e){this._caption.textContent=t,this._image.src=e,this._image.alt="Photo of ".concat(t),super.open()}}(".popup_type_zoom");L.setEventListeners();const k=new i(".popup_type_profile",(t=>{k.renderLoading(!0," Adding..."),u.setUserInfo({name:t.name,about:t.about,avatar:t.avatar}).then((t=>{v.setUserInfo({nameInput:t.name,aboutInput:t.about,avatarInput:t.avatar}),v.setAvatarInfo(t.avatar),k.close()})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{k.renderLoading(!1)}))}));k.setEventListeners();const C=new i(".popup_type_avatar",(t=>{(t=>{C.renderLoading(!0,"Changing..."),u.editAvatar(t.url).then((t=>{v.setAvatar(t.avatar)})).catch((t=>console.log("Error somthing went wrong. ".concat(t)))).finally((()=>{C.renderLoading(!1)}))})(t),C.close()}));c.addEventListener("click",(()=>{f[formImg.getAttribute("name")].resetValidation(),y.setEventListeners(),y.open()})),h.addEventListener("click",(()=>{f[formProfile.getAttribute("name")].resetValidation(),v.getUserInfo(),(()=>{const{name:t,about:e}=v.getUserInfo();a.value=t,l.value=e})(),k.open()})),C.setEventListeners(),d.addEventListener("click",(()=>{f[formAvatar.getAttribute("name")].resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RnVDLEVBQWdCcEcsaUJBQWlCLFNBQVMsS0EvQ3hDdUssRUFBZVksUUFBUVIsYUFBYSxTQUFTUyxrQkFpRDdDZixFQUFZbEcsb0JBQ1prRyxFQUFZckcsTUFBWixJQUdGa0MsRUFBaUJsRyxpQkFBaUIsU0FBUyxLQS9CekN1SyxFQUFlekUsWUFBWTZFLGFBQWEsU0FBU1Msa0JBQzdCaEMsRUFBUzlCLGNBUkMsTUFDOUIsTUFBTSxLQUFFMUksRUFBRixNQUFRcUgsR0FBVW1ELEVBQVM5QixjQUNqQzFCLEVBQVVQLE1BQVF6RyxFQUNsQm9ILEVBQVdYLE1BQVFZLENBQW5CLEVBTUFvRixHQUNBTixFQUFZL0csTUE2QmEsSUFFM0JpSCxFQUFjOUcsb0JBRWRrQyxFQUFnQnJHLGlCQUFpQixTQUFTLEtBN0R4Q3VLLEVBQWVwRSxXQUFXd0UsYUFBYSxTQUFTUyxrQkErRGhESCxFQUFjakgsTUFBZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbGl0aWVzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICB1c2VySWQsXHJcbiAgICBzZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b24sXHJcbiAgICBoYW5kbGVEZWxldGVcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbjtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZSA9IGhhbmRsZURlbGV0ZTtcclxuICAgIHRoaXMuX2FsdCA9IGBQaG90byBvZiAke2RhdGEubmFtZX1gO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVFbGVtZW50ID0gc2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09IHRoaXMuX3VzZXJJZCk7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQgPSAoKSA9PiB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZGVsZXRlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9saWtlQ2FyZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZClcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VDYXJkLmNsYXNzTGlzdC5hZGQoXCJidXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG4gIFxyXG4gIHJlbW92ZUxpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiYnV0dG9uX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXMobmV3TGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XHJcbiAgICBjb25zdCBsaWtlc0Ftb3VudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlrZV9fY291bnRlclwiKS50ZXh0Q29udGVudCA9IGxpa2VzQW1vdW50O1xyXG4gICAgaWYgKHRoaXMuX293bmVyICE9PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgdGhpcy5fZGVsZXRlQ2FyZC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgcmV0dXJuICh0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlRWxlbWVudClcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pdGVtXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSkpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2VuZXJhdGVDYXJkKCk7XHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pbWdcIik7XHJcbiAgICB0aGlzLl9nYWxsZXJ5VGV4dCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVzY19fdGV4dFwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUNhcmQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2JpblwiKTtcclxuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9nYWxsZXJ5VGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nLnNyYyA9IHRoaXMuX2xpbms7XHJcblxyXG4gICAgdGhpcy5fZ2FsbGVyeUltZy5hbHQgPSB0aGlzLl9hbHQ7XHJcbiAgICB0aGlzLnNldExpa2VzKHRoaXMuX2xpa2VzKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XHJcbiAgICAgIHRoaXMuYWRkTGlrZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZW1vdmVMaWtlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fYWxsSW5wdXRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuXHJcbiAgICB0aGlzLl9idXR0b25FbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLmJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5faGlkZUFsbEVycm9ycygpO1xyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gIH07XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fYWxsSW5wdXRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBfaGlkZUFsbEVycm9ycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2FsbElucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9KTtcclxuICB9O1xyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICBjb25zdCB7IGJ1dHRvbkRpc2FibGUgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgdGhpcy5fYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShidXR0b25EaXNhYmxlKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG4gIF9kaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5hZGQoYnV0dG9uRGlzYWJsZSk7XHJcbiAgICB0aGlzLl9idXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfTtcclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWwsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIHNwYW5FcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2Vycm9yRHluYW1pY1NwYW4gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLmZpZWxkc2V0X19lcnJvci10eXBlLSR7aW5wdXRFbC5pZH1gXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JEeW5hbWljU3Bhbi50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yRHluYW1pY1NwYW4uY2xhc3NMaXN0LmFkZChzcGFuRXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWwpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBzcGFuRXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9lcnJvckR5bmFtaWNTcGFuID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC5maWVsZHNldF9fZXJyb3ItdHlwZS0ke2lucHV0RWwuaWR9YFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yRHluYW1pY1NwYW4uY2xhc3NMaXN0LnJlbW92ZShzcGFuRXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvckR5bmFtaWNTcGFuLnRleHRDb250ZW50ID0gXCJcIjtcclxuICB9O1xyXG5cclxuICBfY2hlY2tGb3JtVmFsaWRpdHkgPSAoKSA9PlxyXG4gICAgdGhpcy5fYWxsSW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBfdG9nZ2xlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIGNvbnN0IGlzSW5wdXRzVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xyXG5cclxuICAgIGlmIChpc0lucHV0c1ZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbCkgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcbiAgX2hhbmRsZU92ZXJsYXkgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlT3ZlcmxheSk7XHJcbiAgICB0aGlzLl9wb3B1cFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtID0gaGFuZGxlRm9ybTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZmllbGRzZXRfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcblxyXG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZmllbGRzZXRfX2lucHV0XCIpKTtcclxuICB9XHJcblxyXG4gIHNob3dMb2FkaW5nKCkge1xyXG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0O1xyXG4gIH1cclxuXHJcbiAgaGlkZUxvYWRpbmcoKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0LnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgdmFsdWVzID0ge307XHJcblxyXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGtleSA9IGlucHV0Lm5hbWU7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgIHZhbHVlc1trZXldID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB2YWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdmFsdWVzRnJvbUZvcm0gPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG5cclxuICAgICAgdGhpcy5faGFuZGxlRm9ybSh2YWx1ZXNGcm9tRm9ybSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5jb25zdCBnYWxsZXJ5V3JhcCA9IFwiLmdhbGxlcnlcIjtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBcIi5wb3B1cF90eXBlX2F2YXRhclwiO1xyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBcIi5wb3B1cF90eXBlX2NhcmRcIjtcclxuY29uc3QgcHJvZmlsZVBvcHVwID0gXCIucG9wdXBfdHlwZV9wcm9maWxlXCI7XHJcbmNvbnN0IG9wZW5JbWdWaWV3ID0gXCIucG9wdXBfdHlwZV96b29tXCI7XHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmZvcm1zLmZvcm1Qcm9maWxlLmVsZW1lbnRzLm5hbWU7XHJcbmNvbnN0IGFib3V0SW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtUHJvZmlsZS5lbGVtZW50cy5hYm91dDtcclxuY29uc3QgYXZhdGFySW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtQXZhdGFyLmVsZW1lbnRzLmxpbms7XHJcbmNvbnN0IHRlbXBsYXRlU2VsZWN0b3IgPSBcIiNnYWxsZXJ5X19pdGVtXCI7XHJcbmNvbnN0IHByb2ZpbGVTcGFuQXJyYXkgPSB7XHJcbiAgbmFtZTogXCIudGV4dF9fbmFtZVwiLFxyXG4gIGFib3V0OiBcIi50ZXh0X19hYm91dFwiLFxyXG4gIGF2YXRhcjogXCIudG9wX19pbWdcIixcclxufTtcclxuXHJcbmNvbnN0IG9wZW5Qcm9maWxlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRleHRfX2VkaXRcIik7XHJcbmNvbnN0IG9wZW5JbWdBZGRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9wX19wbHVzLWJveFwiKTtcclxuY29uc3Qgb3BlbkF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3BfX2NvbnRhaW5lci1pbWFnZVwiKTtcclxuLy9zZXR0aW5nc1xyXG5jb25zdCBzZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5maWVsZHNldF9faW5wdXRcIixcclxuICBidXR0b25TZWxlY3RvcjogXCIuZmllbGRzZXRfX2J1dHRvblwiLFxyXG4gIGJ1dHRvbkRpc2FibGU6IFwiZmllbGRzZXRfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmaWVsZHNldF9faW5wdXRfZXJyb3JcIixcclxuICBzcGFuRXJyb3JDbGFzczogXCJmaWVsZHNldF9fZXJyb3ItbWVzc2FnZS1hY3RpdmVcIixcclxufTtcclxubGV0IHVzZXJJZDtcclxubGV0IHNlY3Rpb25OZXcgPSBcIlwiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcblxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNmVmYjcxNWYtM2YyNy00N2FhLWIxMWItMDBkNDc2YmI4MGEyXCIsXHJcblxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5leHBvcnQge1xyXG4gIGdhbGxlcnlXcmFwLFxyXG4gIGF2YXRhclBvcHVwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBwcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ1ZpZXcsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGFib3V0SW5wdXQsXHJcbiAgYXZhdGFySW5wdXQsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlU3BhbkFycmF5LFxyXG4gIG9wZW5BdmF0YXJQb3B1cCxcclxuICBvcGVuUHJvZmlsZVBvcHVwLFxyXG4gIG9wZW5JbWdBZGRQb3B1cCxcclxuICBzZXR0aW5ncyxcclxuICB1c2VySWQsXHJcbiAgc2VjdGlvbk5ldyxcclxuICBhcGksXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBzZXR0aW5ncy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IHNldHRpbmdzLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY3VzdG9tRmV0Y2godXJsLCBoZWFkZXJzKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBoZWFkZXJzKS50aGVuKChyZXMpID0+XHJcbiAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzVGV4dClcclxuICAgICk7XHJcbiAgfVxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcblxyXG5pbXBvcnQge1xyXG4gIGdhbGxlcnlXcmFwLFxyXG4gIGF2YXRhclBvcHVwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBwcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ1ZpZXcsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlU3BhbkFycmF5LFxyXG4gIG9wZW5BdmF0YXJQb3B1cCxcclxuICBvcGVuUHJvZmlsZVBvcHVwLFxyXG4gIG9wZW5JbWdBZGRQb3B1cCxcclxuICBzZXR0aW5ncyxcclxuICBuYW1lSW5wdXQsXHJcbiAgYWJvdXRJbnB1dCxcclxuICBhdmF0YXJJbnB1dCxcclxuICBhcGksXHJcbn0gZnJvbSBcIi4uL3V0aWxpdGllcy9jb25zdGFudHNcIjtcclxuXHJcbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoXCIucG9wdXBfdHlwZV9kZWxldGVcIik7XHJcblxyXG5jb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oKGRhdGEpID0+IHtcclxuICByZW5kZXJDYXJkKGRhdGEpO1xyXG59LCBnYWxsZXJ5V3JhcCk7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcclxuICBzZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XHJcbn07XHJcblxyXG4vL2Z1bmN0aW9ucy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlU3BhbkFycmF5KTtcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0Q2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lSW5wdXQ6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGFib3V0SW5wdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgfSk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIHNlY3Rpb24ucmVuZGVySW5pdGlhbEl0ZW1zKGNhcmRzRGF0YSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKTtcclxuXHJcbmNvbnN0IHN1Ym1pdFByb2ZpbGVGb3JtSW5wdXRzID0gKGRhdGEpID0+IHtcclxuICBwcm9maWxlRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUsIFwiIEFkZGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5zZXRVc2VySW5mbyh7IG5hbWU6IGRhdGEubmFtZSwgYWJvdXQ6IGRhdGEuYWJvdXQsIGF2YXRhcjogZGF0YS5hdmF0YXIgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lSW5wdXQ6IGRhdGEubmFtZSxcclxuICAgICAgICBhYm91dElucHV0OiBkYXRhLmFib3V0LFxyXG4gICAgICAgIGF2YXRhcklucHV0OiBkYXRhLmF2YXRhcixcclxuICAgICAgfSk7XHJcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhckluZm8oZGF0YS5hdmF0YXIpO1xyXG4gICAgICBwcm9maWxlRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICB9LFxyXG4gICAgKGlkKSA9PiB7XHJcbiAgICAgIGlmIChjYXJkLmlzTGlrZWQoKSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRpc2xpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlTGlrZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmxpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgIGNhcmQuYWRkTGlrZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgKGNhcmRJZCkgPT4ge1xyXG4gICAgICBjb25maXJtUG9wdXAub3BlbigpO1xyXG4gICAgICBjb25maXJtUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICAgIGNvbmZpcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7fSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuY3JlYXRlQ2FyZCgpO1xyXG59O1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShhZGRDYXJkUG9wdXAsIChkYXRhKSA9PiB7XHJcbiAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHsgbmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5saW5rIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzLCBnYWxsZXJ5V3JhcCk7XHJcbiAgICAgIGFkZENhcmRGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYWRkQ2FyZEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtXCIpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWwpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWwuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCByZXNldEF2YXRhckZvcm0gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybUF2YXRhci5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxufTtcclxuY29uc3QgcmVzZXRJbWdBZGRGb3JtID0gKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm1JbWcuZ2V0QXR0cmlidXRlKFwibmFtZVwiKV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZUF2YXRhclN1Ym1pdCA9IChkYXRhKSA9PiB7XHJcbiAgcHJvZmlsZUF2YXRhci5yZW5kZXJMb2FkaW5nKHRydWUsIFwiQ2hhbmdpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhcihkYXRhLnVybClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVBdmF0YXIucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtSW5wdXRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBhYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XHJcbn07XHJcblxyXG5jb25zdCByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tmb3JtUHJvZmlsZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1JbnB1dHMocHJvZmlsZURhdGEpO1xyXG4gIHByb2ZpbGVGb3JtLm9wZW4oKTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vY2xhc3Nlcy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uob3BlbkltZ1ZpZXcpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlUG9wdXAsIHN1Ym1pdFByb2ZpbGVGb3JtSW5wdXRzKTtcclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBuZXcgUG9wdXBXaXRoRm9ybShhdmF0YXJQb3B1cCwgKGRhdGEpID0+IHtcclxuICBoYW5kbGVBdmF0YXJTdWJtaXQoZGF0YSk7XHJcbiAgcHJvZmlsZUF2YXRhci5jbG9zZSgpO1xyXG59KTtcclxuXHJcbi8vbGlzdGVuZXJzLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbm9wZW5JbWdBZGRQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHJlc2V0SW1nQWRkRm9ybSgpO1xyXG4gIGFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgYWRkQ2FyZEZvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbm9wZW5Qcm9maWxlUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSgpO1xyXG59KTtcclxucHJvZmlsZUF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxub3BlbkF2YXRhclBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcmVzZXRBdmF0YXJGb3JtKCk7XHJcbiAgcHJvZmlsZUF2YXRhci5vcGVuKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLnBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aFN1Ym1pdDtcclxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgLy8gdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckluaXRpYWxJdGVtcyhpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEubmFtZSk7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuYWJvdXQpO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5hdmF0YXIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgYWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl91c2VyQXZhdGFyLnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWVJbnB1dCwgYWJvdXRJbnB1dCB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWVJbnB1dDtcclxuICAgIHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCA9IGFib3V0SW5wdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRBdmF0YXIoYXZhdGFySW5wdXQpIHtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFySW5wdXQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWdcIik7XHJcbiAgfVxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsInVzZXJJZCIsInNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUJ1dHRvbiIsImhhbmRsZURlbGV0ZSIsInRoaXMiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJfbmFtZSIsIm5hbWUiLCJfdXNlcklkIiwiX2xpbmsiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXIiLCJvd25lciIsIl9pZCIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGUiLCJfYWx0IiwiX3RlbXBsYXRlRWxlbWVudCIsImlzTGlrZWQiLCJzb21lIiwibGlrZSIsImdldElkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2RlbGV0ZUNhcmQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VDYXJkIiwiX2dhbGxlcnlJbWciLCJhZGRMaWtlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlTGlrZSIsInNldExpa2VzIiwibmV3TGlrZXMiLCJsaWtlc0Ftb3VudCIsImxlbmd0aCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsInN0eWxlIiwiZGlzcGxheSIsIl9nZW5lcmF0ZUNhcmQiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjcmVhdGVDYXJkIiwiX2dhbGxlcnlUZXh0Iiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaGlkZUFsbEVycm9ycyIsIl9kaXNhYmxlQnV0dG9uIiwiX2Zvcm1FbGVtZW50IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfYWxsSW5wdXRzIiwiZm9yRWFjaCIsImlucHV0RWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvbiIsImlucHV0IiwiX2hpZGVJbnB1dEVycm9yIiwiYnV0dG9uRGlzYWJsZSIsIl9zZXR0aW5ncyIsIl9idXR0b25FbCIsImRpc2FibGVkIiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwic3BhbkVycm9yQ2xhc3MiLCJfZXJyb3JEeW5hbWljU3BhbiIsImlkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2VuYWJsZUJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJidXR0b25TZWxlY3RvciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2UiLCJrZXkiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZU92ZXJsYXkiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybSIsInN1cGVyIiwiX2hhbmRsZUZvcm0iLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9pbnB1dHMiLCJBcnJheSIsImZyb20iLCJzaG93TG9hZGluZyIsIl9idXR0b25UZXh0IiwiX2xvYWRpbmdCdXR0b25UZXh0IiwiaGlkZUxvYWRpbmciLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInZhbHVlc0Zyb21Gb3JtIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwicmVzZXQiLCJnYWxsZXJ5V3JhcCIsIm5hbWVJbnB1dCIsImZvcm1zIiwiZm9ybVByb2ZpbGUiLCJlbGVtZW50cyIsImFib3V0SW5wdXQiLCJhYm91dCIsIm9wZW5Qcm9maWxlUG9wdXAiLCJmb3JtQXZhdGFyIiwib3BlbkltZ0FkZFBvcHVwIiwib3BlbkF2YXRhclBvcHVwIiwiYXBpIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2N1c3RvbUZldGNoIiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJnZXRDYXJkcyIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImRpc2xpa2VDYXJkIiwibGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY29uZmlybVBvcHVwIiwicG9wdXAiLCJzZXRBY3Rpb24iLCJhY3Rpb24iLCJfc3VibWl0SGFuZGxlciIsInNlY3Rpb24iLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckluaXRpYWxJdGVtcyIsIml0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwicmVuZGVyQ2FyZCIsInVzZXJJbmZvIiwiX3VzZXJOYW1lIiwiX3VzZXJBYm91dCIsIl91c2VyQXZhdGFyIiwic2V0QXZhdGFyIiwiYXZhdGFySW5wdXQiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzRGF0YSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImNhcmQiLCJwb3B1cFdpdGhJbWFnZSIsInJlbW92ZUNhcmQiLCJmaW5hbGx5IiwiYWRkQ2FyZEZvcm0iLCJ0aXRsZSIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybUVsIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJlbmFibGVWYWxpZGF0aW9uIiwiX2NhcHRpb24iLCJfaW1hZ2UiLCJwcm9maWxlRm9ybSIsInNldEF2YXRhckluZm8iLCJwcm9maWxlQXZhdGFyIiwiaGFuZGxlQXZhdGFyU3VibWl0IiwiZm9ybUltZyIsInJlc2V0VmFsaWRhdGlvbiIsImhhbmRsZVByb2ZpbGVGb3JtSW5wdXRzIl0sInNvdXJjZVJvb3QiOiIifQ==