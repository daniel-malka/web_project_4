!function(){"use strict";class e{constructor(e,t,s,r,n,i){var o,a;a=()=>{this._cardElement.remove(),this._cardElement=null},(o="removeCard")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._name=e.name,this._userId=t,this._link=e.link,this._likes=e.likes,this._owner=e.owner._id,this._id=e._id,this._handleCardClick=r,this._handleLikeButton=n,this._handleDelete=i,this._alt="Photo of ".concat(e.name),this._templateElement=s}isLiked(){return this._likes.some((e=>e._id==this._userId))}getId(){return this._id}_setEventListeners(){this._deleteCard.addEventListener("click",(()=>this._handleDelete(this._id))),this._likeCard.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._galleryImg.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}_addLike(){this._likeCard.classList.add("button_liked")}_removeLike(){this._likeCard.classList.remove("button_liked")}setLikes(e){this._likes=e,console.log(this._owner,"owner",this._userId,"userId"),this._renderLikes()}_hideDeleteButton(){this._owner!==this._userId&&(this._deleteCard.style.display="none")}_renderLikes(){this.isLiked()?this._addLike():this._removeLike();const e=this._likes.length;this._counterLikes.textContent=e}_generateCard(){return this._cardElement=document.querySelector(this._templateElement).content.querySelector(".gallery__item").cloneNode(!0)}createCard(){return this._cardElement=this._generateCard(),this._galleryImg=this._cardElement.querySelector(".gallery__img"),this._galleryText=this._cardElement.querySelector(".desc__text"),this._deleteCard=this._cardElement.querySelector(".gallery__bin"),this._likeCard=this._cardElement.querySelector(".like__button"),this._counterLikes=this._cardElement.querySelector(".like__counter"),this._galleryText.textContent=this._name,this._galleryImg.src=this._link,this._galleryImg.alt=this._alt,this._renderLikes(),this._hideDeleteButton(),this._setEventListeners(),this._cardElement}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s){t(this,"resetValidation",(()=>{this._hideAllErrors(),this._disableButton()})),t(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()})),t(this,"_setEventListeners",(()=>{this._allInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),t(this,"_hideAllErrors",(()=>{this._allInputs.forEach((e=>{this._hideInputError(e)}))})),t(this,"_disableButton",(()=>{const{buttonDisable:e}=this._settings;this._buttonEl.classList.add(e),this._buttonEl.disabled=!0})),t(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,spanErrorClass:r}=this._settings;this._errorElement=this._formElement.querySelector(".fieldset__error-type-".concat(e.id)),e.classList.add(s),this._errorElement.textContent=t,this._errorElement.classList.add(r)})),t(this,"_hideInputError",(e=>{const{inputErrorClass:t,spanErrorClass:s}=this._settings;this._errorElement=this._formElement.querySelector(".fieldset__error-type-".concat(e.id)),e.classList.remove(t),this._errorElement.classList.remove(s),this._errorElement.textContent=""})),t(this,"_checkFormValidity",(()=>this._allInputs.every((e=>e.validity.valid)))),t(this,"_toggleButton",(()=>{const{buttonDisable:e}=this._settings;this._checkFormValidity()?this._enableButton():this._disableButton()})),t(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),this._settings=e,this._formElement=s,this._allInputs=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonEl=this._formElement.querySelector(this._settings.buttonSelector)}_enableButton(){const{buttonDisable:e}=this._settings;this._buttonEl.classList.remove(e),this._buttonEl.disabled=!1}}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){r(this,"_handleOverlay",(e=>{e.target.classList.contains("popup")&&this.close()})),r(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",this._handleOverlay),this._popup.querySelector(".popup__close").addEventListener("mousedown",(()=>this.close()))}}class i extends n{constructor(e,t){super(e),this._handleForm=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button"),this._submitButtonText=this._submitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".fieldset__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{const s=t.name,r=t.value;e[s]=r})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleForm(t)}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}close(){super.close(),this._form.reset()}}const o=".gallery",a=document.forms.formProfile.elements.name,l=document.forms.formProfile.elements.about,h=(document.forms.formAvatar.elements.link,document.querySelector(".text__edit")),c=document.querySelector(".top__plus-box"),d=document.querySelector(".top__container-image"),_={inputSelector:".fieldset__input",buttonSelector:".fieldset__button",buttonDisable:"fieldset__button_disabled",inputErrorClass:"fieldset__input_error",spanErrorClass:"fieldset__error-message-active"},u=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}getCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}addCard(e){let{name:t,link:s}=e;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:s})})}editAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}dislikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}}),m=new class extends n{constructor(e){super(e),this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".fieldset__button-type-save"),this._submitButtonText=this._submitButton.textContent}setAction(e){this._submitHandler=e}setEventListeners(){this._popup.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitButton.textContent=e?t:this._submitButtonText}}(".popup_type_delete");let p;m.setEventListeners();const b=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}renderInitialItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}((e=>{g(e)}),o),g=e=>{b.addItem(f(e))},E=new class{constructor(e){this._userName=document.querySelector(e.name),this._userAbout=document.querySelector(e.about),this._userAvatar=document.querySelector(e.avatar)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent,avatar:this._userAvatar.src}}setUserInfo(e){let{nameInput:t,aboutInput:s}=e;this._userName.textContent=t,this._userAbout.textContent=s}setAvatar(e){this._userAvatar.src=e}}({name:".text__name",about:".text__about",avatar:".top__img"});Promise.all([u.getUserInfo(),u.getCards()]).then((e=>{let[t,s]=e;p=t._id,E.setUserInfo({nameInput:t.name,aboutInput:t.about}),E.setAvatar(t.avatar),b.renderInitialItems(s)})).catch((e=>console.log("Error somthing went wrong. ".concat(e))));const f=t=>{const s=new e(t,p,"#gallery__item",((e,t)=>{L.open(e,t)}),(e=>{s.isLiked()?u.dislikeCard(e).then((e=>{s.setLikes(e.likes)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))):u.likeCard(e).then((e=>{s.setLikes(e.likes)})).catch((e=>console.log("Error somthing went wrong. ".concat(e))))}),(e=>{m.open(),m.setAction((()=>{m.renderLoading(!0,"Deleting..."),u.deleteCard(e).then((e=>{s.removeCard(),m.close()})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{m.renderLoading(!1)}))}))}));return s.createCard()},v=new i(".popup_type_card",(e=>{v.renderLoading(!0,"Saving..."),u.addCard({name:e.title,link:e.link}).then((e=>{g(e,o),v.close()})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{v.renderLoading(!1)}))})),y={};Array.from(document.querySelectorAll(".form")).forEach((e=>{const t=new s(_,e),r=e.getAttribute("name");y[r]=t,t.enableValidation()}));const L=new class extends n{constructor(e){super(e),this._popup=document.querySelector(e),this._caption=this._popup.querySelector(".popup__caption"),this._image=this._popup.querySelector(".popup__img")}open(e,t){this._caption.textContent=e,this._image.src=t,this._image.alt="Photo of ".concat(e),super.open()}}(".popup_type_zoom");L.setEventListeners();const k=new i(".popup_type_profile",(e=>{k.renderLoading(!0," Adding..."),u.setUserInfo({name:e.name,about:e.about,avatar:e.avatar}).then((e=>{E.setUserInfo({nameInput:e.name,aboutInput:e.about,avatarInput:e.avatar}),k.close(),E.setAvatarInfo(e.avatar)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{k.renderLoading(!1)}))}));k.setEventListeners();const C=new i(".popup_type_avatar",(e=>{(e=>{C.renderLoading(!0,"Changing..."),u.editAvatar(e.url).then((e=>{E.setAvatar(e.avatar)})).catch((e=>console.log("Error somthing went wrong. ".concat(e)))).finally((()=>{C.renderLoading(!1)}))})(e),C.close()}));c.addEventListener("click",(()=>{y[formImg.getAttribute("name")].resetValidation(),v.open()})),v.setEventListeners(),h.addEventListener("click",(()=>{y[formProfile.getAttribute("name")].resetValidation(),E.getUserInfo(),(()=>{const{name:e,about:t}=E.getUserInfo();a.value=e,l.value=t})(),k.open()})),C.setEventListeners(),d.addEventListener("click",(()=>{y[formAvatar.getAttribute("name")].resetValidation(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0MsR0FBUTlJLFFBQVFDLElBQVIscUNBQTBDNkksTUFDekRLLFNBQVEsS0FDUGEsRUFBY2pGLGVBQWMsRUFBNUIsR0FQSixFQW9DQW1GLENBQW1Cek0sR0FDbkJ1TSxFQUFjdkcsT0FBZCxJQU1GbUMsRUFBZ0JyRyxpQkFBaUIsU0FBUyxLQS9DeEMrSixFQUFlYSxRQUFRVCxhQUFhLFNBQVNVLGtCQWtEN0NoQixFQUFZeEYsTUFBWixJQUVGd0YsRUFBWXJGLG9CQUVaMkIsRUFBaUJuRyxpQkFBaUIsU0FBUyxLQWhDekMrSixFQUFlaEUsWUFBWW9FLGFBQWEsU0FBU1Usa0JBQzdCbEMsRUFBUzdCLGNBUkMsTUFDOUIsTUFBTSxLQUFFbEksRUFBRixNQUFRc0gsR0FBVXlDLEVBQVM3QixjQUNqQ2pCLEVBQVVQLE1BQVExRyxFQUNsQnFILEVBQVdYLE1BQVFZLENBQW5CLEVBTUE0RSxHQUNBUCxFQUFZbEcsTUE4QmEsSUFHM0JvRyxFQUFjakcsb0JBRWQ4QixFQUFnQnRHLGlCQUFpQixTQUFTLEtBL0R4QytKLEVBQWUzRCxXQUFXK0QsYUFBYSxTQUFTVSxrQkFpRWhESixFQUFjcEcsTUFBZCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbGl0aWVzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICB1c2VySWQsXHJcbiAgICBzZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZUxpa2VCdXR0b24sXHJcbiAgICBoYW5kbGVEZWxldGVcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbjtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZSA9IGhhbmRsZURlbGV0ZTtcclxuICAgIHRoaXMuX2FsdCA9IGBQaG90byBvZiAke2RhdGEubmFtZX1gO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVFbGVtZW50ID0gc2VsZWN0b3I7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09IHRoaXMuX3VzZXJJZCk7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9kZWxldGVDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGUodGhpcy5faWQpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2xpa2VDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9nYWxsZXJ5SW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluaylcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfYWRkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VDYXJkLmNsYXNzTGlzdC5hZGQoXCJidXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICBfcmVtb3ZlTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJidXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICBzZXRMaWtlcyhuZXdMaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcclxuICAgIGNvbnNvbGUubG9nKHRoaXMuX293bmVyLCBcIm93bmVyXCIsIHRoaXMuX3VzZXJJZCwgXCJ1c2VySWRcIik7XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICB9XHJcbiAgX2hpZGVEZWxldGVCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5fb3duZXIgIT09IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVDYXJkLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIH1cclxuICB9XHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XHJcbiAgICAgIHRoaXMuX2FkZExpa2UoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3JlbW92ZUxpa2UoKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpa2VzQW1vdW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgdGhpcy5fY291bnRlckxpa2VzLnRleHRDb250ZW50ID0gbGlrZXNBbW91bnQ7XHJcbiAgfVxyXG4gIF9nZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICByZXR1cm4gKHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVFbGVtZW50KVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW1cIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZW5lcmF0ZUNhcmQoKTtcclxuICAgIHRoaXMuX2dhbGxlcnlJbWcgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2ltZ1wiKTtcclxuICAgIHRoaXMuX2dhbGxlcnlUZXh0ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kZXNjX190ZXh0XCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQ2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fYmluXCIpO1xyXG4gICAgdGhpcy5fbGlrZUNhcmQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpa2VfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2NvdW50ZXJMaWtlcyA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubGlrZV9fY291bnRlclwiKTtcclxuICAgIHRoaXMuX2dhbGxlcnlUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2dhbGxlcnlJbWcuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2dhbGxlcnlJbWcuYWx0ID0gdGhpcy5fYWx0O1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuICAgIHRoaXMuX2hpZGVEZWxldGVCdXR0b24oKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICAgIHRoaXMuX2FsbElucHV0cyA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5fYnV0dG9uRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5idXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2hpZGVBbGxFcnJvcnMoKTtcclxuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICB9O1xyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH07XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2FsbElucHV0cy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVBbGxFcnJvcnMgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9hbGxJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcclxuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoYnV0dG9uRGlzYWJsZSk7XHJcbiAgICB0aGlzLl9idXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuICBfZGlzYWJsZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGNvbnN0IHsgYnV0dG9uRGlzYWJsZSB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9idXR0b25FbC5jbGFzc0xpc3QuYWRkKGJ1dHRvbkRpc2FibGUpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH07XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsLCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBzcGFuRXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLmZpZWxkc2V0X19lcnJvci10eXBlLSR7aW5wdXRFbC5pZH1gXHJcbiAgICApO1xyXG5cclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZChpbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoc3BhbkVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsKSA9PiB7XHJcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgc3BhbkVycm9yQ2xhc3MgfSA9IHRoaXMuX3NldHRpbmdzO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC5maWVsZHNldF9fZXJyb3ItdHlwZS0ke2lucHV0RWwuaWR9YFxyXG4gICAgKTtcclxuXHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNwYW5FcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfTtcclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT5cclxuICAgIHRoaXMuX2FsbElucHV0cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGNvbnN0IHsgYnV0dG9uRGlzYWJsZSB9ID0gdGhpcy5fc2V0dGluZ3M7XHJcbiAgICBjb25zdCBpc0lucHV0c1ZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcclxuXHJcbiAgICBpZiAoaXNJbnB1dHNWYWxpZCkge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWwpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIF9oYW5kbGVPdmVybGF5ID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXkpO1xyXG4gICAgdGhpcy5fcG9wdXBcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybSA9IGhhbmRsZUZvcm07XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZpZWxkc2V0X19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZmllbGRzZXRfX2lucHV0XCIpKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBjb25zdCBrZXkgPSBpbnB1dC5uYW1lO1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICB2YWx1ZXNba2V5XSA9IHZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IHZhbHVlc0Zyb21Gb3JtID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuXHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm0odmFsdWVzRnJvbUZvcm0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuY29uc3QgZ2FsbGVyeVdyYXAgPSBcIi5nYWxsZXJ5XCI7XHJcbmNvbnN0IGF2YXRhclBvcHVwID0gXCIucG9wdXBfdHlwZV9hdmF0YXJcIjtcclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gXCIucG9wdXBfdHlwZV9jYXJkXCI7XHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IFwiLnBvcHVwX3R5cGVfcHJvZmlsZVwiO1xyXG5jb25zdCBvcGVuSW1nVmlldyA9IFwiLnBvcHVwX3R5cGVfem9vbVwiO1xyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtUHJvZmlsZS5lbGVtZW50cy5uYW1lO1xyXG5jb25zdCBhYm91dElucHV0ID0gZG9jdW1lbnQuZm9ybXMuZm9ybVByb2ZpbGUuZWxlbWVudHMuYWJvdXQ7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gZG9jdW1lbnQuZm9ybXMuZm9ybUF2YXRhci5lbGVtZW50cy5saW5rO1xyXG5jb25zdCB0ZW1wbGF0ZVNlbGVjdG9yID0gXCIjZ2FsbGVyeV9faXRlbVwiO1xyXG5jb25zdCBwcm9maWxlU3BhbkFycmF5ID0ge1xyXG4gIG5hbWU6IFwiLnRleHRfX25hbWVcIixcclxuICBhYm91dDogXCIudGV4dF9fYWJvdXRcIixcclxuICBhdmF0YXI6IFwiLnRvcF9faW1nXCIsXHJcbn07XHJcblxyXG5jb25zdCBvcGVuUHJvZmlsZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50ZXh0X19lZGl0XCIpO1xyXG5jb25zdCBvcGVuSW1nQWRkUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRvcF9fcGx1cy1ib3hcIik7XHJcbmNvbnN0IG9wZW5BdmF0YXJQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9wX19jb250YWluZXItaW1hZ2VcIik7XHJcbi8vc2V0dGluZ3NcclxuY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZmllbGRzZXRfX2lucHV0XCIsXHJcbiAgYnV0dG9uU2VsZWN0b3I6IFwiLmZpZWxkc2V0X19idXR0b25cIixcclxuICBidXR0b25EaXNhYmxlOiBcImZpZWxkc2V0X19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZmllbGRzZXRfX2lucHV0X2Vycm9yXCIsXHJcbiAgc3BhbkVycm9yQ2xhc3M6IFwiZmllbGRzZXRfX2Vycm9yLW1lc3NhZ2UtYWN0aXZlXCIsXHJcbn07XHJcbmxldCB1c2VySWQ7XHJcbmxldCBzZWN0aW9uTmV3ID0gXCJcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxyXG5cclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjZlZmI3MTVmLTNmMjctNDdhYS1iMTFiLTAwZDQ3NmJiODBhMlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5leHBvcnQge1xyXG4gIGdhbGxlcnlXcmFwLFxyXG4gIGF2YXRhclBvcHVwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBwcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ1ZpZXcsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGFib3V0SW5wdXQsXHJcbiAgYXZhdGFySW5wdXQsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlU3BhbkFycmF5LFxyXG4gIG9wZW5BdmF0YXJQb3B1cCxcclxuICBvcGVuUHJvZmlsZVBvcHVwLFxyXG4gIG9wZW5JbWdBZGRQb3B1cCxcclxuICBzZXR0aW5ncyxcclxuICB1c2VySWQsXHJcbiAgc2VjdGlvbk5ldyxcclxuICBhcGksXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG4gIGdldENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdFwiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcblxyXG5pbXBvcnQge1xyXG4gIGdhbGxlcnlXcmFwLFxyXG4gIGF2YXRhclBvcHVwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBwcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ1ZpZXcsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlU3BhbkFycmF5LFxyXG4gIG9wZW5BdmF0YXJQb3B1cCxcclxuICBvcGVuUHJvZmlsZVBvcHVwLFxyXG4gIG9wZW5JbWdBZGRQb3B1cCxcclxuICBzZXR0aW5ncyxcclxuICBuYW1lSW5wdXQsXHJcbiAgYWJvdXRJbnB1dCxcclxuICBhdmF0YXJJbnB1dCxcclxuICBhcGksXHJcbn0gZnJvbSBcIi4uL3V0aWxpdGllcy9jb25zdGFudHNcIjtcclxuXHJcbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoXCIucG9wdXBfdHlwZV9kZWxldGVcIik7XHJcblxyXG5jb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmxldCB1c2VySWQ7XHJcblxyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oKGRhdGEpID0+IHtcclxuICByZW5kZXJDYXJkKGRhdGEpO1xyXG59LCBnYWxsZXJ5V3JhcCk7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGRhdGEpID0+IHtcclxuICBzZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XHJcbn07XHJcblxyXG4vL2Z1bmN0aW9ucy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlU3BhbkFycmF5KTtcclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0Q2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lSW5wdXQ6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGFib3V0SW5wdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgfSk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIHNlY3Rpb24ucmVuZGVySW5pdGlhbEl0ZW1zKGNhcmRzRGF0YSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKTtcclxuXHJcbmNvbnN0IHN1Ym1pdFByb2ZpbGVGb3JtSW5wdXRzID0gKGRhdGEpID0+IHtcclxuICBwcm9maWxlRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUsIFwiIEFkZGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5zZXRVc2VySW5mbyh7IG5hbWU6IGRhdGEubmFtZSwgYWJvdXQ6IGRhdGEuYWJvdXQsIGF2YXRhcjogZGF0YS5hdmF0YXIgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgICBuYW1lSW5wdXQ6IGRhdGEubmFtZSxcclxuICAgICAgICBhYm91dElucHV0OiBkYXRhLmFib3V0LFxyXG4gICAgICAgIGF2YXRhcklucHV0OiBkYXRhLmF2YXRhcixcclxuICAgICAgfSk7XHJcbiAgICAgIHByb2ZpbGVGb3JtLmNsb3NlKCk7XHJcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhckluZm8oZGF0YS5hdmF0YXIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgdXNlcklkLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgICAgIHBvcHVwV2l0aEltYWdlLm9wZW4obmFtZSwgbGluayk7XHJcbiAgICB9LFxyXG4gICAgKGlkKSA9PiB7XHJcbiAgICAgIGlmIChjYXJkLmlzTGlrZWQoKSkge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLmRpc2xpa2VDYXJkKGlkKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAubGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coYEVycm9yIHNvbXRoaW5nIHdlbnQgd3JvbmcuICR7ZXJyfWApKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIChjYXJkSWQpID0+IHtcclxuICAgICAgY29uZmlybVBvcHVwLm9wZW4oKTtcclxuICAgICAgY29uZmlybVBvcHVwLnNldEFjdGlvbigoKSA9PiB7XHJcbiAgICAgICAgY29uZmlybVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJEZWxldGluZy4uLlwiKTtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICAgIGNvbmZpcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbmZpcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICApO1xyXG4gIHJldHVybiBjYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuXHJcbmNvbnN0IGFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkQ2FyZFBvcHVwLCAoZGF0YSkgPT4ge1xyXG4gIGFkZENhcmRGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZCh7IG5hbWU6IGRhdGEudGl0bGUsIGxpbms6IGRhdGEubGluayB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHJlcywgZ2FsbGVyeVdyYXApO1xyXG4gICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhgRXJyb3Igc29tdGhpbmcgd2VudCB3cm9uZy4gJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybVwiKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybUVsKTtcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsLmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgcmVzZXRBdmF0YXJGb3JtVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tmb3JtQXZhdGFyLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59O1xyXG5jb25zdCByZXNldEltZ0FkZEZvcm0gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybUltZy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxufTtcclxuY29uc3QgaGFuZGxlQXZhdGFyU3VibWl0ID0gKGRhdGEpID0+IHtcclxuICBwcm9maWxlQXZhdGFyLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJDaGFuZ2luZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5lZGl0QXZhdGFyKGRhdGEudXJsKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGBFcnJvciBzb210aGluZyB3ZW50IHdyb25nLiAke2Vycn1gKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUF2YXRhci5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY29uc3QgaGFuZGxlUHJvZmlsZUZvcm1JbnB1dHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgeyBuYW1lLCBhYm91dCB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xyXG4gIGFib3V0SW5wdXQudmFsdWUgPSBhYm91dDtcclxufTtcclxuXHJcbmNvbnN0IHJlc2V0QW5kT3BlblByb2ZpbGVGb3JtID0gKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW2Zvcm1Qcm9maWxlLmdldEF0dHJpYnV0ZShcIm5hbWVcIildLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBoYW5kbGVQcm9maWxlRm9ybUlucHV0cyhwcm9maWxlRGF0YSk7XHJcbiAgcHJvZmlsZUZvcm0ub3BlbigpO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy9jbGFzc2VzLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShvcGVuSW1nVmlldyk7XHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKHByb2ZpbGVQb3B1cCwgc3VibWl0UHJvZmlsZUZvcm1JbnB1dHMpO1xyXG5wcm9maWxlRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUF2YXRhciA9IG5ldyBQb3B1cFdpdGhGb3JtKGF2YXRhclBvcHVwLCAoZGF0YSkgPT4ge1xyXG4gIGhhbmRsZUF2YXRhclN1Ym1pdChkYXRhKTtcclxuICBwcm9maWxlQXZhdGFyLmNsb3NlKCk7XHJcbn0pO1xyXG5cclxuLy9saXN0ZW5lcnMvLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxub3BlbkltZ0FkZFBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcmVzZXRJbWdBZGRGb3JtKCk7XHJcblxyXG4gIGFkZENhcmRGb3JtLm9wZW4oKTtcclxufSk7XHJcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5vcGVuUHJvZmlsZVBvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcmVzZXRBbmRPcGVuUHJvZmlsZUZvcm0oKTtcclxufSk7XHJcblxyXG5wcm9maWxlQXZhdGFyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5vcGVuQXZhdGFyUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEF2YXRhckZvcm1WYWxpZGF0aW9uKCk7XHJcbiAgcHJvZmlsZUF2YXRhci5vcGVuKCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5jbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5maWVsZHNldF9fYnV0dG9uLXR5cGUtc2F2ZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcbiAgc2V0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIkRlbGV0aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhTdWJtaXQ7XHJcbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJJbml0aWFsSXRlbXMoaXRlbXMpIHtcclxuICAgICAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEpIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkYXRhLm5hbWUpO1xyXG4gICAgdGhpcy5fdXNlckFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkYXRhLmFib3V0KTtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuYXZhdGFyKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fdXNlckF2YXRhci5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lSW5wdXQsIGFib3V0SW5wdXQgfSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lSW5wdXQ7XHJcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSBhYm91dElucHV0O1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGF2YXRhcklucHV0KSB7XHJcbiAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IGF2YXRhcklucHV0O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2FwdGlvblwiKTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1nXCIpO1xyXG4gIH1cclxuICBvcGVuKG5hbWUsIGxpbmspIHtcclxuICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHRoaXMuX2ltYWdlLmFsdCA9IGBQaG90byBvZiAke25hbWV9YDtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ1c2VySWQiLCJzZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VCdXR0b24iLCJoYW5kbGVEZWxldGUiLCJ0aGlzIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX25hbWUiLCJuYW1lIiwiX3VzZXJJZCIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX293bmVyIiwib3duZXIiLCJfaWQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlIiwiX2FsdCIsIl90ZW1wbGF0ZUVsZW1lbnQiLCJpc0xpa2VkIiwic29tZSIsImxpa2UiLCJnZXRJZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9kZWxldGVDYXJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9saWtlQ2FyZCIsIl9nYWxsZXJ5SW1nIiwiX2FkZExpa2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJfcmVtb3ZlTGlrZSIsInNldExpa2VzIiwibmV3TGlrZXMiLCJjb25zb2xlIiwibG9nIiwiX3JlbmRlckxpa2VzIiwiX2hpZGVEZWxldGVCdXR0b24iLCJzdHlsZSIsImRpc3BsYXkiLCJsaWtlc0Ftb3VudCIsImxlbmd0aCIsIl9jb3VudGVyTGlrZXMiLCJ0ZXh0Q29udGVudCIsIl9nZW5lcmF0ZUNhcmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY3JlYXRlQ2FyZCIsIl9nYWxsZXJ5VGV4dCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2hpZGVBbGxFcnJvcnMiLCJfZGlzYWJsZUJ1dHRvbiIsIl9mb3JtRWxlbWVudCIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX2FsbElucHV0cyIsImZvckVhY2giLCJpbnB1dEVsIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b24iLCJpbnB1dCIsIl9oaWRlSW5wdXRFcnJvciIsImJ1dHRvbkRpc2FibGUiLCJfc2V0dGluZ3MiLCJfYnV0dG9uRWwiLCJkaXNhYmxlZCIsImVycm9yTWVzc2FnZSIsImlucHV0RXJyb3JDbGFzcyIsInNwYW5FcnJvckNsYXNzIiwiX2Vycm9yRWxlbWVudCIsImlkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2VuYWJsZUJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJidXR0b25TZWxlY3RvciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsInRhcmdldCIsImNvbnRhaW5zIiwiY2xvc2UiLCJrZXkiLCJfcG9wdXAiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2hhbmRsZU92ZXJsYXkiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybSIsInN1cGVyIiwiX2hhbmRsZUZvcm0iLCJfZm9ybSIsIl9zdWJtaXRCdXR0b24iLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9pbnB1dHMiLCJBcnJheSIsImZyb20iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsInZhbHVlc0Zyb21Gb3JtIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwicmVzZXQiLCJnYWxsZXJ5V3JhcCIsIm5hbWVJbnB1dCIsImZvcm1zIiwiZm9ybVByb2ZpbGUiLCJlbGVtZW50cyIsImFib3V0SW5wdXQiLCJhYm91dCIsIm9wZW5Qcm9maWxlUG9wdXAiLCJmb3JtQXZhdGFyIiwib3BlbkltZ0FkZFBvcHVwIiwib3BlbkF2YXRhclBvcHVwIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0Q2FyZHMiLCJmZXRjaCIsImdldFVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZENhcmQiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImRpc2xpa2VDYXJkIiwibGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiY29uZmlybVBvcHVwIiwic2V0QWN0aW9uIiwiYWN0aW9uIiwiX3N1Ym1pdEhhbmRsZXIiLCJzZWN0aW9uIiwicmVuZGVyZXIiLCJjb250YWluZXJTZWxlY3RvciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJbml0aWFsSXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsInJlbmRlckNhcmQiLCJ1c2VySW5mbyIsIl91c2VyTmFtZSIsIl91c2VyQWJvdXQiLCJfdXNlckF2YXRhciIsInNldEF2YXRhciIsImF2YXRhcklucHV0IiwiUHJvbWlzZSIsImFsbCIsInRoZW4iLCJ1c2VyRGF0YSIsImNhcmRzRGF0YSIsImNhdGNoIiwiZXJyIiwiY2FyZCIsInBvcHVwV2l0aEltYWdlIiwicmVzIiwicmVtb3ZlQ2FyZCIsImZpbmFsbHkiLCJhZGRDYXJkRm9ybSIsInRpdGxlIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtRWwiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJfY2FwdGlvbiIsIl9pbWFnZSIsInByb2ZpbGVGb3JtIiwic2V0QXZhdGFySW5mbyIsInByb2ZpbGVBdmF0YXIiLCJ1cmwiLCJoYW5kbGVBdmF0YXJTdWJtaXQiLCJmb3JtSW1nIiwicmVzZXRWYWxpZGF0aW9uIiwiaGFuZGxlUHJvZmlsZUZvcm1JbnB1dHMiXSwic291cmNlUm9vdCI6IiJ9