!function(){"use strict";class e{constructor(e,t,s,r,i){var n,o;o=()=>this._cardElement.remove(),(n="_removeCard")in this?Object.defineProperty(this,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[n]=o,this._name=e.name,this._userId=t._id,this._link=e.link,this._likes=e.likes,this._ownerId=e.owner._id,this._id=e._id,this._handleCardClick=r,this._handleLikeButton=i,this._alt="Photo of ".concat(e.name),this._templateElement=s}getOwner(){console.log(this._owner)}isLiked(){return this._likes.some((e=>e._id==this._ownerId))}getId(){return this._id}_setEventListeners(){this._deleteCard.addEventListener("click",(()=>this._removeCard())),this._likeCard.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._galleryImg.addEventListener("click",(()=>this._handleCardClick(this._name,this._link)))}addLike(){this._likeCard.classList.add("button_liked")}removeLike(){this._likeCard.classList.remove("button_liked")}setLikes(e){this._likes=e,this.likesAmount=this._likes.length,this._likesCounter.textContent=this.likesAmount}createCard(){return this._cardElement=document.querySelector(this._templateElement).content.querySelector(".gallery__item").cloneNode(!0),this._galleryImg=this._cardElement.querySelector(".gallery__img"),this._galleryText=this._cardElement.querySelector(".desc__text"),this._deleteCard=this._cardElement.querySelector(".gallery__bin"),this._likeCard=this._cardElement.querySelector(".like__button"),this._likesCounter=this._cardElement.querySelector(".like__counter"),this._galleryText.textContent=this._name,this._galleryImg.src=this._link,this._galleryImg.alt=this._alt,this.setLikes(this._likes),this._setEventListeners(),this._cardElement}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s){t(this,"resetValidation",(()=>{this._hideAllErrors(),this._formElement.reset(),this._disableButton()})),t(this,"enableValidation",(()=>{this._formElement.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()})),t(this,"_setEventListeners",(()=>{this._allInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton(this._allInputs)}))}))})),t(this,"_hideAllErrors",(()=>{this._allInputs.forEach((e=>{this._hideInputError(e)}))})),t(this,"_disableButton",(()=>{const{buttonDisable:e}=this._settings;this._buttonEl.classList.add(e),this._buttonEl.disabled=!0})),t(this,"_showInputError",((e,t)=>{const{inputErrorClass:s,spanErrorClass:r}=this._settings;this._errorDynamicSpan=this._formElement.querySelector(".fieldset__error-type-".concat(e.id)),e.classList.add(s),this._errorDynamicSpan.textContent=t,this._errorDynamicSpan.classList.add(r)})),t(this,"_hideInputError",(e=>{const{inputErrorClass:t,spanErrorClass:s}=this._settings;this._errorDynamicSpan=this._formElement.querySelector(".fieldset__error-type-".concat(e.id)),e.classList.remove(t),this._errorDynamicSpan.classList.remove(s),this._errorDynamicSpan.textContent=""})),t(this,"_toggleButton",(e=>{const{buttonDisable:t}=this._settings;e.every((e=>e.validity.valid))?(this._buttonEl.classList.remove(t),this._buttonEl.disabled=!1):this._disableButton()})),t(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),this._settings=e,this._formElement=s,this._allInputs=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonEl=this._formElement.querySelector(this._settings.buttonSelector)}}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){r(this,"_handleOverlay",(e=>{e.target.classList.contains("popup")&&this.close()})),r(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",this._handleOverlay),this._popup.querySelector(".popup__close").addEventListener("mousedown",(()=>this.close()))}}class n extends i{constructor(e,t){super(e),this._handleForm=t,this._form=this._popup.querySelector(".form"),this._inputs=Array.from(this._form.querySelectorAll(".fieldset__input"))}_getInputValues(){return this._values={},this._inputs.forEach((e=>{this._key=e.name,this._value=e.value,this._values[this._key]=this._value})),this._values}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._valuesFromForm=this._getInputValues(),this._handleForm(this._valuesFromForm),super.close()}))}setInputValues(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}close(){super.close(),this._form.reset()}}const o=".gallery",a=document.forms.formProfile.elements.name,l=document.forms.formProfile.elements.about,h=document.querySelector(".text__edit"),_=document.querySelector(".top__plus-box"),c={inputSelector:".fieldset__input",buttonSelector:".fieldset__button",buttonDisable:"fieldset__button_disabled",inputErrorClass:"fieldset__input_error",spanErrorClass:"fieldset__error-message-active"},u=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))).catch((e=>{console.log(e)})),d=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getCards(){return u(this._baseUrl+"/cards",{headers:this._headers})}getUserInfo(){return u(this._baseUrl+"/users/me",{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return u(this._baseUrl+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}addCard(e){let{name:t,link:s}=e;return u(this._baseUrl+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:s})})}deleteCard(e){return u("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}dislikeCard(e){return u("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}likeCard(e){return u("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6efb715f-3f27-47aa-b11b-00d476bb80a2","Content-Type":"application/json"}});let m;const p=new class{constructor(e,t){this._renderer=e,this._container=document.querySelector(t)}renderInitialItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}((e=>{b(e)}),o),b=e=>{p.addItem(E(e))},f=new class{constructor(e){this._userName=document.querySelector(e.name),this._userAbout=document.querySelector(e.about)}getUserInfo(){return{name:this._userName.textContent,about:this._userAbout.textContent}}setUserInfo(e){let{nameInput:t,aboutInput:s}=e;this._userName.textContent=t,this._userAbout.textContent=s}}({name:".text__name",about:".text__about"});Promise.all([d.getUserInfo(),d.getCards()]).then((e=>{let[t,s]=e;m=t._id,f.setUserInfo({nameInput:t.name,aboutInput:t.about}),p.renderInitialItems(s)})).catch(console.log);const E=t=>{const s=new e(t,m,"#gallery__item",((e,t)=>{k.open(e,t)}),(e=>{const t=s.isLiked();t?t&&d.dislikeCard(e).then((e=>{s.setLikes(e.likes),s.removeLike()})):(console.log(e),d.likeCard(e).then((e=>{s.setLikes(e.likes),s.addLike()})))}));return s.createCard()},y=new n(".popup_type_card",(e=>{d.addCard({title:e.title,link:e.link}).then((e=>{b(e,o),y.close()})).catch(console.log)})),g={formImg:"formImg",formProfile:"formProfile"};Array.from(document.querySelectorAll(".form")).forEach((e=>{const t=new s(c,e),r=e.getAttribute("name");g[r]=t,t.enableValidation()}));const k=new class extends i{open(e,t){this._image=this._popup.querySelector(".popup__img"),this._caption=this._popup.querySelector(".popup__caption"),this._caption.textContent=e,this._image.src=t,this._image.alt="Photo of ".concat(e),super.open()}}(".popup_type_zoom");k.setEventListeners();const v=new n(".popup_type_profile",(e=>{d.setUserInfo({name:e.name,about:e.about}).then((e=>{console.log(e),f.setUserInfo({nameInput:e.name,aboutInput:e.about})})).catch((e=>console.log(e,"something went wrong.. =/"))).finally((()=>{v.close()}))}));v.setEventListeners(),y.setEventListeners(),_.addEventListener("click",(()=>(g[formImg.getAttribute("name")].resetValidation(),void y.open()))),h.addEventListener("click",(()=>{g[formProfile.getAttribute("name")].resetValidation(),f.getUserInfo(),(()=>{const{name:e,about:t}=f.getUserInfo();a.value=e,l.value=t})(),v.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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THVCLFFBQVFDLElBQUl4QixHQUNacUssRUFBU3RCLFlBQVksQ0FDbkIzQixVQUFXcEgsRUFBS1MsS0FDaEIrRyxXQUFZeEgsRUFBS3lILE9BRm5CLElBS0RjLE9BQU9DLEdBQVFqSCxRQUFRQyxJQUFJZ0gsRUFBSywrQkFDaENpRCxTQUFRLEtBQ1BELEVBQVkxRixPQUFaLEdBWEosSUFxR0YwRixFQUFZcEYsb0JBRVp5RSxFQUFZekUsb0JBS1p1QixFQUFnQjNGLGlCQUFpQixTQUFTLEtBaEN4QytJLEVBQWVDLFFBQVFJLGFBQWEsU0FBU00sdUJBQzdDYixFQUFZNUUsVUFpQ2R5QixFQUFzQjFGLGlCQUFpQixTQUFTLEtBeEI5QytJLEVBQWV6RCxZQUFZOEQsYUFBYSxTQUFTTSxrQkFDN0JyQixFQUFTdkIsY0FSQyxNQUM5QixNQUFNLEtBQUVySSxFQUFGLE1BQVFnSCxHQUFVNEMsRUFBU3ZCLGNBQ2pDMUIsRUFBVUosTUFBUXZHLEVBQ2xCK0csRUFBV1IsTUFBUVMsQ0FBbkIsRUFNQWtFLEdBQ0FILEVBQVl2RixNQXNCYSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbGl0aWVzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIHVzZXJJZCwgc2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUJ1dHRvbikge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkLl9pZDtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XG4gICAgdGhpcy5fYWx0ID0gYFBob3RvIG9mICR7ZGF0YS5uYW1lfWA7XG4gICAgdGhpcy5fdGVtcGxhdGVFbGVtZW50ID0gc2VsZWN0b3I7XG4gIH1cbiAgZ2V0T3duZXIoKSB7XG4gICAgY29uc29sZS5sb2codGhpcy5fb3duZXIpO1xuICB9XG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09IHRoaXMuX293bmVySWQpO1xuICB9XG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuICBfcmVtb3ZlQ2FyZCA9ICgpID0+IHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9kZWxldGVDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9yZW1vdmVDYXJkKCkpO1xuICAgIHRoaXMuX2xpa2VDYXJkLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbih0aGlzLl9pZClcbiAgICApO1xuICAgIHRoaXMuX2dhbGxlcnlJbWcuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluaylcbiAgICApO1xuICB9XG4gIGFkZExpa2UoKSB7XG4gICAgdGhpcy5fbGlrZUNhcmQuY2xhc3NMaXN0LmFkZChcImJ1dHRvbl9saWtlZFwiKTtcbiAgfVxuICByZW1vdmVMaWtlKCkge1xuICAgIHRoaXMuX2xpa2VDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJidXR0b25fbGlrZWRcIik7XG4gIH1cblxuICBzZXRMaWtlcyhuZXdMaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbmV3TGlrZXM7XG4gICAgdGhpcy5saWtlc0Ftb3VudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcbiAgICB0aGlzLl9saWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLmxpa2VzQW1vdW50O1xuICB9XG5cbiAgY3JlYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZUVsZW1lbnQpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2l0ZW1cIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9nYWxsZXJ5SW1nID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19pbWdcIik7XG4gICAgdGhpcy5fZ2FsbGVyeVRleHQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlc2NfX3RleHRcIik7XG4gICAgdGhpcy5fZGVsZXRlQ2FyZCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fYmluXCIpO1xuICAgIHRoaXMuX2xpa2VDYXJkID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlX19idXR0b25cIik7XG4gICAgdGhpcy5fbGlrZXNDb3VudGVyID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlX19jb3VudGVyXCIpO1xuICAgIHRoaXMuX2dhbGxlcnlUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9nYWxsZXJ5SW1nLnNyYyA9IHRoaXMuX2xpbms7XG5cbiAgICB0aGlzLl9nYWxsZXJ5SW1nLmFsdCA9IHRoaXMuX2FsdDtcbiAgICB0aGlzLnNldExpa2VzKHRoaXMuX2xpa2VzKTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2FsbElucHV0cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9idXR0b25FbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5idXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cbiAgcmVzZXRWYWxpZGF0aW9uID0gKCkgPT4ge1xuICAgIHRoaXMuX2hpZGVBbGxFcnJvcnMoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgfTtcbiAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuICBfc2V0RXZlbnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgdGhpcy5fYWxsSW5wdXRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b24odGhpcy5fYWxsSW5wdXRzKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuICBfaGlkZUFsbEVycm9ycyA9ICgpID0+IHtcbiAgICB0aGlzLl9hbGxJbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9KTtcbiAgfTtcbiAgX2Rpc2FibGVCdXR0b24gPSAoKSA9PiB7XG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICB0aGlzLl9idXR0b25FbC5jbGFzc0xpc3QuYWRkKGJ1dHRvbkRpc2FibGUpO1xuICAgIHRoaXMuX2J1dHRvbkVsLmRpc2FibGVkID0gdHJ1ZTtcbiAgfTtcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0RWwsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBzcGFuRXJyb3JDbGFzcyB9ID0gdGhpcy5fc2V0dGluZ3M7XG4gICAgdGhpcy5fZXJyb3JEeW5hbWljU3BhbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLmZpZWxkc2V0X19lcnJvci10eXBlLSR7aW5wdXRFbC5pZH1gXG4gICAgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoaW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvckR5bmFtaWNTcGFuLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yRHluYW1pY1NwYW4uY2xhc3NMaXN0LmFkZChzcGFuRXJyb3JDbGFzcyk7XG4gIH07XG4gIF9oaWRlSW5wdXRFcnJvciA9IChpbnB1dEVsKSA9PiB7XG4gICAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIHNwYW5FcnJvckNsYXNzIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICB0aGlzLl9lcnJvckR5bmFtaWNTcGFuID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuZmllbGRzZXRfX2Vycm9yLXR5cGUtJHtpbnB1dEVsLmlkfWBcbiAgICApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yRHluYW1pY1NwYW4uY2xhc3NMaXN0LnJlbW92ZShzcGFuRXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JEeW5hbWljU3Bhbi50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH07XG4gIF90b2dnbGVCdXR0b24gPSAoaW5wdXRzKSA9PiB7XG4gICAgY29uc3QgeyBidXR0b25EaXNhYmxlIH0gPSB0aGlzLl9zZXR0aW5ncztcbiAgICBjb25zdCBpc0lucHV0c1ZhbGlkID0gaW5wdXRzLmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuXG4gICAgaWYgKGlzSW5wdXRzVmFsaWQpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUoYnV0dG9uRGlzYWJsZSk7XG4gICAgICB0aGlzLl9idXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9O1xuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0RWwpID0+IHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG4gIF9oYW5kbGVPdmVybGF5ID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlT3ZlcmxheSk7XG4gICAgdGhpcy5fcG9wdXBcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm0pIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtID0gaGFuZGxlRm9ybTtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLmZpZWxkc2V0X19pbnB1dFwiKSk7XG4gIH1cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX3ZhbHVlcyA9IHt9O1xuXG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9rZXkgPSBpbnB1dC5uYW1lO1xuICAgICAgdGhpcy5fdmFsdWUgPSBpbnB1dC52YWx1ZTtcbiAgICAgIHRoaXMuX3ZhbHVlc1t0aGlzLl9rZXldID0gdGhpcy5fdmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX3ZhbHVlcztcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3ZhbHVlc0Zyb21Gb3JtID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm0odGhpcy5fdmFsdWVzRnJvbUZvcm0pO1xuICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgfVxufVxuIiwiY29uc3QgZ2FsbGVyeVdyYXAgPSAnLmdhbGxlcnknO1xuY29uc3QgYWRkQ2FyZFBvcHVwID0gJy5wb3B1cF90eXBlX2NhcmQnO1xuY29uc3QgcHJvZmlsZVBvcHVwID0gJy5wb3B1cF90eXBlX3Byb2ZpbGUnO1xuY29uc3Qgb3BlbkltZ1ZpZXcgPSAnLnBvcHVwX3R5cGVfem9vbSc7XG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5mb3Jtcy5mb3JtUHJvZmlsZS5lbGVtZW50cy5uYW1lO1xuY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LmZvcm1zLmZvcm1Qcm9maWxlLmVsZW1lbnRzLmFib3V0O1xuY29uc3QgdGVtcGxhdGVTZWxlY3RvciA9ICcjZ2FsbGVyeV9faXRlbSc7XG5jb25zdCBwcm9maWxlU3BhbkFycmF5ID0ge1xuICAgIG5hbWU6ICcudGV4dF9fbmFtZScsXG4gICAgYWJvdXQ6ICcudGV4dF9fYWJvdXQnLFxufTtcblxuY29uc3Qgb3BlblByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRleHRfX2VkaXQnKTtcbmNvbnN0IG9wZW5JbWdBZGRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b3BfX3BsdXMtYm94Jyk7XG4vL3NldHRpbmdzXG5jb25zdCBzZXR0aW5ncyA9IHtcbiAgICBpbnB1dFNlbGVjdG9yOiAnLmZpZWxkc2V0X19pbnB1dCcsXG4gICAgYnV0dG9uU2VsZWN0b3I6ICcuZmllbGRzZXRfX2J1dHRvbicsXG4gICAgYnV0dG9uRGlzYWJsZTogJ2ZpZWxkc2V0X19idXR0b25fZGlzYWJsZWQnLFxuICAgIGlucHV0RXJyb3JDbGFzczogJ2ZpZWxkc2V0X19pbnB1dF9lcnJvcicsXG4gICAgc3BhbkVycm9yQ2xhc3M6ICdmaWVsZHNldF9fZXJyb3ItbWVzc2FnZS1hY3RpdmUnLFxufTtcbmxldCB1c2VySWQ7XG5sZXQgc2VjdGlvbk5ldyA9ICcnO1xuZXhwb3J0IHtcbiAgICBnYWxsZXJ5V3JhcCxcbiAgICBhZGRDYXJkUG9wdXAsXG4gICAgcHJvZmlsZVBvcHVwLFxuICAgIG9wZW5JbWdWaWV3LFxuICAgIG5hbWVJbnB1dCxcbiAgICBhYm91dElucHV0LFxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXG4gICAgcHJvZmlsZVNwYW5BcnJheSxcbiAgICBvcGVuUHJvZmlsZUVkaXRCdXR0b24sXG4gICAgb3BlbkltZ0FkZFBvcHVwLFxuICAgIHNldHRpbmdzLFxuICAgIHVzZXJJZCxcbiAgICBzZWN0aW9uTmV3LFxufTtcbiIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4ge1xyXG4gIHJldHVybiBmZXRjaCh1cmwsIGhlYWRlcnMpXHJcbiAgICAudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSkpXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gc2V0dGluZ3MuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBzZXR0aW5ncy5oZWFkZXJzO1xyXG4gIH1cclxuICBnZXRDYXJkcygpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKHRoaXMuX2Jhc2VVcmwgKyBgL3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuICBkaXNsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjZlZmI3MTVmLTNmMjctNDdhYS1iMTFiLTAwZDQ3NmJiODBhMlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQge1xyXG4gIGdhbGxlcnlXcmFwLFxyXG4gIGFkZENhcmRQb3B1cCxcclxuICBwcm9maWxlUG9wdXAsXHJcbiAgb3BlbkltZ1ZpZXcsXHJcbiAgdGVtcGxhdGVTZWxlY3RvcixcclxuICBwcm9maWxlU3BhbkFycmF5LFxyXG4gIG9wZW5Qcm9maWxlRWRpdEJ1dHRvbixcclxuICBvcGVuSW1nQWRkUG9wdXAsXHJcbiAgc2V0dGluZ3MsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGFib3V0SW5wdXQsXHJcbn0gZnJvbSBcIi4uL3V0aWxpdGllcy9jb25zdGFudHNcIjtcclxuaW1wb3J0IHsgYXBpIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XHJcbmxldCB1c2VySWQ7XHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbigoZGF0YSkgPT4ge1xyXG4gIHJlbmRlckNhcmQoZGF0YSk7XHJcbn0sIGdhbGxlcnlXcmFwKTtcclxuXHJcbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIHNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGEpKTtcclxufTtcclxuLy9mdW5jdGlvbnMvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVTcGFuQXJyYXkpO1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc0RhdGFdKSA9PiB7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWVJbnB1dDogdXNlckRhdGEubmFtZSxcclxuICAgICAgYWJvdXRJbnB1dDogdXNlckRhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIHNlY3Rpb24ucmVuZGVySW5pdGlhbEl0ZW1zKGNhcmRzRGF0YSk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5sb2cpO1xyXG5jb25zdCBzdWJtaXRQcm9maWxlRm9ybUlucHV0cyA9IChkYXRhKSA9PiB7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8oeyBuYW1lOiBkYXRhLm5hbWUsIGFib3V0OiBkYXRhLmFib3V0IH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIG5hbWVJbnB1dDogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0SW5wdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIH0pO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIsIFwic29tZXRoaW5nIHdlbnQgd3JvbmcuLiA9L1wiKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUZvcm0uY2xvc2UoKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIHVzZXJJZCxcclxuICAgIHRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICAobmFtZSwgbGluaykgPT4ge1xyXG4gICAgICBwb3B1cFdpdGhJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xyXG4gICAgfSxcclxuICAgIChpZCkgPT4ge1xyXG4gICAgICBjb25zdCBpc0xpa2VkID0gY2FyZC5pc0xpa2VkKCk7XHJcbiAgICAgIGlmICghaXNMaWtlZCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGlkKTtcclxuICAgICAgICBhcGkubGlrZUNhcmQoaWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgY2FyZC5hZGRMaWtlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gICAuY2F0Y2goY29uc29sZS5sb2coKSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoaXNMaWtlZCkge1xyXG4gICAgICAgIGFwaS5kaXNsaWtlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICBjYXJkLnJlbW92ZUxpa2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICk7XHJcbiAgLy8gIGNvbnN0IGlzQWxyZWFkeUxpa2VkID0gY2FyZC5pc0xpa2VkKCk7XHJcblxyXG4gIC8vICAgICAgICAgaWYgKGlzQWxyZWFkeUxpa2VkKSB7XHJcbiAgLy8gICAgICAgICAgIGFwaS5kaXNsaWtlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgLy8gICAgICAgICAgICAgY2FyZC5saWtlQ2FyZChyZXMubGlrZXMpO1xyXG4gIC8vICAgICAgICAgICB9KS5jYXRjaChjb25zb2xlLmxvZyk7IDtcclxuICAvLyAgICAgICAgIH0gZWxzZSB7XHJcbiAgLy8gICAgICAgICAgIGFwaS5saWtlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgLy8gICAgICAgICAgICAgY2FyZC5saWtlQ2FyZChyZXMubGlrZXMpO1xyXG4gIC8vICAgICAgICAgICB9KS5jYXRjaChjb25zb2xlLmxvZyk7IDtcclxuICAvLyAgICAgICAgIH1cclxuICAvLyAgICAgICB9LFxyXG4gIHJldHVybiBjYXJkLmNyZWF0ZUNhcmQoKTtcclxufTtcclxuXHJcbmNvbnN0IGFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkQ2FyZFBvcHVwLCAoZGF0YSkgPT4ge1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyB0aXRsZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5saW5rIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzLCBnYWxsZXJ5V3JhcCk7XHJcbiAgICAgIGFkZENhcmRGb3JtLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUubG9nKTtcclxufSk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHsgZm9ybUltZzogXCJmb3JtSW1nXCIsIGZvcm1Qcm9maWxlOiBcImZvcm1Qcm9maWxlXCIgfTtcclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtXCIpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWwpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWwuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcbmNvbnN0IHJlc2V0QW5kT3BlbkltZ0FkZEZvcm0gPSAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbZm9ybUltZy5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhZGRDYXJkRm9ybS5vcGVuKCk7XHJcbn07XHJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtSW5wdXRzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHsgbmFtZSwgYWJvdXQgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gbmFtZTtcclxuICBhYm91dElucHV0LnZhbHVlID0gYWJvdXQ7XHJcbn07XHJcblxyXG5jb25zdCByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSA9ICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tmb3JtUHJvZmlsZS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1JbnB1dHMocHJvZmlsZURhdGEpO1xyXG4gIHByb2ZpbGVGb3JtLm9wZW4oKTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vY2xhc3Nlcy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uob3BlbkltZ1ZpZXcpO1xyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShwcm9maWxlUG9wdXAsIHN1Ym1pdFByb2ZpbGVGb3JtSW5wdXRzKTtcclxucHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2xpc3RlbmVycy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5vcGVuSW1nQWRkUG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHJlc2V0QW5kT3BlbkltZ0FkZEZvcm0oKSk7XHJcblxyXG5vcGVuUHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICByZXNldEFuZE9wZW5Qcm9maWxlRm9ybSgpO1xyXG59KTtcclxuIiwiZXhwb3J0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICByZW5kZXJJbml0aWFsSXRlbXMoaXRlbXMpIHtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhZGRJdGVtKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoZGF0YSkge1xuICAgIHRoaXMuX3VzZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkYXRhLm5hbWUpO1xuICAgIHRoaXMuX3VzZXJBYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5hYm91dCk7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX3VzZXJBYm91dC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG4gIHNldFVzZXJJbmZvKHsgbmFtZUlucHV0LCBhYm91dElucHV0IH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCA9IG5hbWVJbnB1dDtcbiAgICB0aGlzLl91c2VyQWJvdXQudGV4dENvbnRlbnQgPSBhYm91dElucHV0O1xuICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4obmFtZSwgbGluaykge1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1nXCIpO1xuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xuXG4gICAgKHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lKSxcbiAgICAgICh0aGlzLl9pbWFnZS5zcmMgPSBsaW5rKSxcbiAgICAgICh0aGlzLl9pbWFnZS5hbHQgPSBgUGhvdG8gb2YgJHtuYW1lfWApO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ1c2VySWQiLCJzZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VCdXR0b24iLCJ0aGlzIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX25hbWUiLCJuYW1lIiwiX3VzZXJJZCIsIl9pZCIsIl9saW5rIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX293bmVySWQiLCJvd25lciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9hbHQiLCJfdGVtcGxhdGVFbGVtZW50IiwiZ2V0T3duZXIiLCJjb25zb2xlIiwibG9nIiwiX293bmVyIiwiaXNMaWtlZCIsInNvbWUiLCJsaWtlIiwiZ2V0SWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfZGVsZXRlQ2FyZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfcmVtb3ZlQ2FyZCIsIl9saWtlQ2FyZCIsIl9nYWxsZXJ5SW1nIiwiYWRkTGlrZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZUxpa2UiLCJzZXRMaWtlcyIsIm5ld0xpa2VzIiwibGlrZXNBbW91bnQiLCJsZW5ndGgiLCJfbGlrZXNDb3VudGVyIiwidGV4dENvbnRlbnQiLCJjcmVhdGVDYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9nYWxsZXJ5VGV4dCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2hpZGVBbGxFcnJvcnMiLCJfZm9ybUVsZW1lbnQiLCJyZXNldCIsIl9kaXNhYmxlQnV0dG9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfYWxsSW5wdXRzIiwiZm9yRWFjaCIsImlucHV0RWwiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvbiIsImlucHV0IiwiX2hpZGVJbnB1dEVycm9yIiwiYnV0dG9uRGlzYWJsZSIsIl9zZXR0aW5ncyIsIl9idXR0b25FbCIsImRpc2FibGVkIiwiZXJyb3JNZXNzYWdlIiwiaW5wdXRFcnJvckNsYXNzIiwic3BhbkVycm9yQ2xhc3MiLCJfZXJyb3JEeW5hbWljU3BhbiIsImlkIiwiaW5wdXRzIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3Nob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsImJ1dHRvblNlbGVjdG9yIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwidGFyZ2V0IiwiY29udGFpbnMiLCJjbG9zZSIsImtleSIsIl9wb3B1cCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfaGFuZGxlT3ZlcmxheSIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtIiwic3VwZXIiLCJfaGFuZGxlRm9ybSIsIl9mb3JtIiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsIl92YWx1ZXMiLCJfa2V5IiwiX3ZhbHVlIiwidmFsdWUiLCJfdmFsdWVzRnJvbUZvcm0iLCJzZXRJbnB1dFZhbHVlcyIsImdhbGxlcnlXcmFwIiwibmFtZUlucHV0IiwiZm9ybXMiLCJmb3JtUHJvZmlsZSIsImVsZW1lbnRzIiwiYWJvdXRJbnB1dCIsImFib3V0Iiwib3BlblByb2ZpbGVFZGl0QnV0dG9uIiwib3BlbkltZ0FkZFBvcHVwIiwiY3VzdG9tRmV0Y2giLCJ1cmwiLCJoZWFkZXJzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1c1RleHQiLCJjYXRjaCIsImVyciIsImFwaSIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0Q2FyZHMiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGRDYXJkIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImRpc2xpa2VDYXJkIiwibGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbiIsInJlbmRlcmVyIiwiY29udGFpbmVyU2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySW5pdGlhbEl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJyZW5kZXJDYXJkIiwidXNlckluZm8iLCJfdXNlck5hbWUiLCJfdXNlckFib3V0IiwiYWxsIiwidXNlckRhdGEiLCJjYXJkc0RhdGEiLCJjYXJkIiwicG9wdXBXaXRoSW1hZ2UiLCJhZGRDYXJkRm9ybSIsInRpdGxlIiwiZm9ybVZhbGlkYXRvcnMiLCJmb3JtSW1nIiwiZm9ybUVsIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJlbmFibGVWYWxpZGF0aW9uIiwiX2ltYWdlIiwiX2NhcHRpb24iLCJwcm9maWxlRm9ybSIsImZpbmFsbHkiLCJyZXNldFZhbGlkYXRpb24iLCJoYW5kbGVQcm9maWxlRm9ybUlucHV0cyJdLCJzb3VyY2VSb290IjoiIn0=